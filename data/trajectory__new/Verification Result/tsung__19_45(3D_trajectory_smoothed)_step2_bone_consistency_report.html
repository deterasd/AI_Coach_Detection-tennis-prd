<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>step2. 骨架一致性驗證儀表板</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400&display=swap');

        :root {
            --bg-color: #050505;
            --card-bg: rgba(20, 20, 20, 0.6);
            --card-border: rgba(255, 255, 255, 0.08);
            --text-main: #f3f4f6;
            --text-sub: #9ca3af;
            --accent-primary: #6366f1;
            --accent-secondary: #a855f7;
            --accent-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            --success: #34d399;
            --warning: #fbbf24;
            --danger: #f87171;
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: 'Inter', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-color);
            background-image: 
                radial-gradient(circle at 15% 0%, rgba(99, 102, 241, 0.15) 0%, transparent 35%),
                radial-gradient(circle at 85% 30%, rgba(168, 85, 247, 0.15) 0%, transparent 35%);
            background-attachment: fixed;
            color: var(--text-main);
            margin: 0;
            padding: 40px 20px;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 24px 32px;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 24px;
            border: 1px solid var(--card-border);
            box-shadow: var(--glass-shadow);
        }

        h1 {
            margin: 0;
            font-weight: 700;
            font-size: 1.75rem;
            letter-spacing: -0.02em;
            background: linear-gradient(to right, #fff, #cbd5e1);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        h1 span {
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
            position: relative;
        }
        
        h1 span::after {
            content: 'BETA';
            position: absolute;
            top: -8px;
            right: -30px;
            font-size: 0.6rem;
            background: var(--accent-gradient);
            -webkit-text-fill-color: #fff;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .upload-section {
            display: flex;
            align-items: center;
        }

        input[type="file"] {
            display: none;
        }

        /* New Styles for Comprehensive View */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .summary-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--accent-gradient);
            opacity: 0.7;
        }

        .summary-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-main);
        }

        .summary-label {
            font-size: 0.9rem;
            color: var(--text-sub);
            font-weight: 500;
        }

        .score-card {
            display: grid;
            grid-template-columns: minmax(240px, 0.35fr) minmax(320px, 1fr);
            gap: 28px;
            align-items: stretch;
            padding: 20px 28px;
            margin-bottom: 32px;
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.16), rgba(15, 23, 42, 0.6));
            box-shadow: var(--glass-shadow);
        }

        .score-main {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .score-label {
            font-size: 0.95rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-sub);
        }

        .score-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 3.5rem;
            font-weight: 800;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .score-level {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-main);
        }

        .score-progress {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 999px;
            overflow: hidden;
        }

        .score-progress-fill {
            height: 100%;
            background: var(--accent-gradient);
            border-radius: 999px;
            transition: width 0.3s ease;
        }

        .score-summary {
            font-size: 0.9rem;
            color: var(--text-sub);
            margin: 0;
            line-height: 1.5;
        }

        .score-details {
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 18px;
            padding: 16px 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .score-detail-header {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .score-detail-header h3 {
            margin: 0;
            font-size: 1.05rem;
            color: var(--text-main);
        }

        .score-detail-subtitle {
            font-size: 0.85rem;
            color: var(--text-sub);
        }

        .score-detail-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .score-detail-item {
            display: flex;
            justify-content: space-between;
            gap: 18px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        }

        .score-detail-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .score-detail-item.score-empty {
            flex-direction: column;
            gap: 4px;
            color: var(--text-sub);
            font-size: 0.9rem;
            border-bottom: none;
            padding-bottom: 0;
        }

        .score-detail-label {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-main);
        }

        .score-detail-desc {
            font-size: 0.85rem;
            color: var(--text-sub);
        }

        .score-detail-value {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-main);
            min-width: 120px;
        }

        .impact-negative {
            color: var(--danger);
            font-weight: 600;
        }

        .impact-positive {
            color: var(--success);
            font-weight: 600;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 60px 0 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-main);
        }

        .section-title::before {
            content: '';
            display: block;
            width: 4px;
            height: 24px;
            background: var(--accent-secondary);
            border-radius: 2px;
        }

        .data-table-container {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            border-radius: 24px;
            padding: 24px;
            overflow-x: auto;
            margin-bottom: 40px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        th {
            text-align: left;
            padding: 16px;
            color: var(--text-sub);
            font-weight: 600;
            border-bottom: 1px solid var(--card-border);
            white-space: nowrap;
        }

        td {
            padding: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
            color: var(--text-main);
            font-family: 'JetBrains Mono', monospace;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover td {
            background: rgba(255, 255, 255, 0.02);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 99px;
            font-size: 0.8rem;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
        }

        .status-success { background: rgba(52, 211, 153, 0.15); color: #34d399; border: 1px solid rgba(52, 211, 153, 0.2); }
        .status-warning { background: rgba(251, 191, 36, 0.15); color: #fbbf24; border: 1px solid rgba(251, 191, 36, 0.2); }
        .status-danger { background: rgba(248, 113, 113, 0.15); color: #f87171; border: 1px solid rgba(248, 113, 113, 0.2); }
        .status-neutral { background: rgba(156, 163, 175, 0.15); color: #9ca3af; border: 1px solid rgba(156, 163, 175, 0.2); }

        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 3px;
        }

        .two-col-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 24px;
        }

        .file-upload-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            color: var(--text-main);
            padding: 10px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .file-upload-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .file-upload-btn span {
            font-size: 1.1rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 24px;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 24px;
            padding: 28px;
            border: 1px solid var(--card-border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            border-color: rgba(99, 102, 241, 0.3);
        }

        .card-header {
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-main);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .card-title::before {
            content: '';
            display: block;
            width: 6px;
            height: 6px;
            background: var(--accent-gradient);
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
        }

        .chart-wrapper {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 24px;
            border: 1px solid rgba(255, 255, 255, 0.02);
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .info-section {
            margin-top: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: rgba(255, 255, 255, 0.02);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.03);
        }

        .info-item {
            display: grid;
            grid-template-columns: 85px 1fr;
            gap: 16px;
            align-items: baseline;
        }

        .info-badge {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            padding: 4px 0;
            text-align: center;
            border-radius: 6px;
            letter-spacing: 0.05em;
        }

        .badge-desc { background: rgba(255, 255, 255, 0.08); color: var(--text-sub); }
        .badge-criteria { background: rgba(251, 191, 36, 0.1); color: var(--warning); border: 1px solid rgba(251, 191, 36, 0.2); }
        .badge-params { background: rgba(99, 102, 241, 0.1); color: #818cf8; border: 1px solid rgba(99, 102, 241, 0.2); }

        .info-text {
            font-size: 0.9rem;
            color: var(--text-sub);
            margin: 0;
            line-height: 1.5;
        }

        .text-criteria { color: #e5e7eb; font-weight: 500; }
        .text-params { font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; color: #94a3b8; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #444; }

        @media (max-width: 768px) {
            header { flex-direction: column; gap: 20px; text-align: center; padding: 20px; }
            .grid { grid-template-columns: 1fr; }
            .info-item { grid-template-columns: 1fr; gap: 6px; }
            .info-badge { width: fit-content; padding: 4px 10px; }
            .score-card { grid-template-columns: 1fr; }
            .score-detail-value { align-items: flex-start; }
        }
    </style>

    <script>
        window.OFFLINE_DATA = {
  "metadata": {
    "analysis_time": "2025-12-21T17:26:23.243607",
    "source_file": "data/trajectory__new/tsung__19_45(3D_trajectory_smoothed).json",
    "total_frames": 141,
    "analysis_type": "Bone Consistency Analysis"
  },
  "overall_summary": {
    "average_cv": 5.980907960337013,
    "quality_level": "可接受",
    "total_bones_analyzed": 16,
    "total_spikes_detected": 0
  },
  "overall_quality": {
    "average_cv": 5.980907960337013,
    "quality_level": "可接受"
  },
  "bone_statistics": {
    "頭部": {
      "mean": 7.1567863732512,
      "std": 0.682581267492534,
      "cv": 9.537538664612251,
      "count": 141,
      "mean_diff": 0.06763234150671467,
      "max_diff": 0.48337241878643233,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.8965735037204318,
        "p_value": 1.877731389939679e-08,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 32,
        "rate": 22.69503546099291,
        "bounds": [
          6.241477487309897,
          7.886081367115093
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        5.899417125064099,
        5.874815225638574,
        5.8749745723585445,
        5.886204742962553,
        5.902767446744766,
        5.924522212511925,
        5.954770300250682,
        5.998382484816284,
        6.066399148871537,
        6.165992603794918,
        6.279310910933091,
        6.387816597769645,
        6.499390540229446,
        6.594025506947378,
        6.677453569475206,
        6.759493917451449,
        6.836046693479683,
        6.90319111592404,
        6.958849602683962,
        7.017490610195429,
        7.084138784598345,
        7.161118128009553,
        7.245310604721093,
        7.30428630576329,
        7.329264085567061,
        7.337951118302664,
        7.333139873648345,
        7.306112266628648,
        7.268093252006233,
        7.238676652697994,
        7.2163513626077815,
        7.2088820244108165,
        7.205830565722922,
        7.219647353522893,
        7.23735809731574,
        7.256090227231477,
        7.264590217047909,
        7.2646939049568715,
        7.26896533987712,
        7.268225237587406,
        7.2554271991674995,
        7.232257413914401,
        7.195717980933613,
        7.16593937467799,
        7.134087295496227,
        7.114557501608109,
        7.103070950100175,
        7.112839934585534,
        7.129349669403949,
        7.151899660222744,
        7.177121033687849,
        7.212339359429772,
        7.250447935949121,
        7.28906316406142,
        7.321366006696539,
        7.341883596249214,
        7.333936058616923,
        7.315341599874364,
        7.292455332729122,
        7.277440169280654,
        7.268490741866015,
        7.257616433140458,
        7.237002019500428,
        7.20393239727831,
        7.165368307023553,
        7.117403178563871,
        7.062961621483032,
        7.010796084137608,
        6.973565203262278,
        6.956406044828421,
        6.957135246888359,
        6.973103738766605,
        6.998752140774118,
        7.03849952823842,
        7.077399289486989,
        7.1124918825613905,
        7.138871451336101,
        7.155300045633149,
        7.164767498251026,
        7.15586409537273,
        7.127086315437784,
        7.080007967035884,
        7.021030714635016,
        6.958902439219825,
        6.9024416591153495,
        6.859732393888699,
        6.834849468786925,
        6.825174387557096,
        6.823164988816538,
        6.826053382967883,
        6.831835998927396,
        6.840160925584189,
        6.8582039422368455,
        6.8858840218550785,
        6.9222703012677815,
        6.963220906294438,
        7.012540334611538,
        7.074035946701413,
        7.1427025411833345,
        7.209281366556053,
        7.2693549121881444,
        7.286865152965743,
        7.249120828814749,
        7.16070072011698,
        7.006645387367125,
        6.813281349083576,
        6.628427937298727,
        6.482108181447449,
        6.374791758814951,
        6.303118887590334,
        6.245367771359083,
        6.186678725346554,
        6.137253457568734,
        6.137952025592972,
        6.236088895279601,
        6.460449792409138,
        6.809103754559956,
        7.2522313664699425,
        7.735603785256375,
        8.190321819420774,
        8.590853428775308,
        8.89366271883894,
        9.059798057804052,
        9.117597655763799,
        9.058285355748401,
        8.971994696960174,
        8.856966247277976,
        8.745235840985258,
        8.623836339348083,
        8.505609676187227,
        8.397678726454698,
        8.318676648792762,
        8.266380976776727,
        8.21526512681539,
        8.160722529505309,
        8.09009286963271,
        7.996174321816669,
        7.872244142791745,
        7.712281041927321,
        7.511299627588594,
        7.265867571592445
      ]
    },
    "脊柱": {
      "mean": 55.57764367139176,
      "std": 1.5290319682347489,
      "cv": 2.751163718410409,
      "count": 141,
      "mean_diff": 0.10963731295604927,
      "max_diff": 0.48760006268204137,
      "quality_level": "良好",
      "shapiro_test": {
        "statistic": 0.937615025159912,
        "p_value": 6.514463580110067e-06,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          51.82284920270361,
          58.83015148760272
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        55.6881669189717,
        55.30461151017138,
        55.0197537090199,
        54.81911122281027,
        54.68825968346296,
        54.61287276982358,
        54.57879259542521,
        54.572130503760675,
        54.579857478335875,
        54.57514649133829,
        54.5502358419197,
        54.49317000592267,
        54.41432936726411,
        54.31337101044242,
        54.19851839717323,
        54.074707485802094,
        53.93319877506197,
        53.806479354371575,
        53.70221187746752,
        53.61687940667207,
        53.55273257140696,
        53.51496127212764,
        53.47979990578891,
        53.44372692730377,
        53.41146939954207,
        53.38096115990663,
        53.34105535055344,
        53.29514115918594,
        53.25315631624967,
        53.223256391539636,
        53.219335496510425,
        53.258060652034395,
        53.32921249188787,
        53.45088467880229,
        53.61644596875591,
        53.8084174998469,
        54.00028683384111,
        54.19492652069117,
        54.36665269790657,
        54.494480316979185,
        54.55549151402387,
        54.56545357806224,
        54.52546680322541,
        54.45058755954078,
        54.35199503790788,
        54.24887011724959,
        54.14895903257559,
        54.092060980478365,
        54.06744188760554,
        54.09064860817616,
        54.17412072381535,
        54.32029393724183,
        54.511798616029736,
        54.73278728219225,
        54.93508398181054,
        55.118718533193544,
        55.257567915937294,
        55.35059686122734,
        55.40764660147785,
        55.44416063392706,
        55.47269477807365,
        55.52430758552373,
        55.606827522294324,
        55.744595757055855,
        55.90881655476072,
        56.06477803261113,
        56.18397924106917,
        56.251934739601396,
        56.2707192962975,
        56.25742118138483,
        56.207014496045076,
        56.14617420496718,
        56.066495556837836,
        55.949939464277975,
        55.78261321362062,
        55.60594806716059,
        55.4600757450807,
        55.38273143482288,
        55.37753338085133,
        55.45548922028744,
        55.59052473508975,
        55.74207340334046,
        55.88729818754009,
        55.99914845290954,
        56.05228254795893,
        56.0361251547446,
        55.95317774722422,
        55.82577708914348,
        55.73222601997501,
        55.67670435822107,
        55.62691880368449,
        55.577154836033515,
        55.566608530087194,
        55.59322220706734,
        55.63552057663327,
        55.72197287283517,
        55.85924483541993,
        56.02698338434523,
        56.20241313076556,
        56.32546034252168,
        56.378895438592906,
        56.37375194852693,
        56.299779266021744,
        56.131013085905714,
        55.88742159970816,
        55.62184752540111,
        55.380486937118874,
        55.17817609468623,
        55.0477193553294,
        55.031486167852236,
        55.13013234249523,
        55.35555981610577,
        55.7014310284825,
        56.128328930889005,
        56.61510631389772,
        57.10270637657976,
        57.50311898275595,
        57.76994133283455,
        57.92057947264742,
        57.9519150561584,
        57.916406346467525,
        57.842746704238856,
        57.771014399700036,
        57.73242112526933,
        57.74382670609846,
        57.83394475972045,
        57.988706764459195,
        58.1701848441838,
        58.35818090215766,
        58.52129166765631,
        58.644642043424156,
        58.73338956984084,
        58.79761702143738,
        58.811983309787216,
        58.778561896459394,
        58.72640636936461,
        58.663176503939624,
        58.595835193936445,
        58.53056284767261,
        58.47277437685701,
        58.427242331637466
      ]
    },
    "肩寬": {
      "mean": 32.460931766686265,
      "std": 2.6629495179060227,
      "cv": 8.203552310346595,
      "count": 141,
      "mean_diff": 0.21672005101100816,
      "max_diff": 1.2744247901543915,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.7870006160880922,
        "p_value": 4.858588163846658e-13,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 16,
        "rate": 11.347517730496454,
        "bounds": [
          26.88105844563093,
          36.99499983423861
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        32.177698383599534,
        31.386353060689622,
        30.859918102523515,
        30.518400035587206,
        30.305642775365904,
        30.184534148840562,
        30.13131394974183,
        30.130143637039833,
        30.163890254840474,
        30.224139858946508,
        30.290260284553653,
        30.35060312387656,
        30.390046519228793,
        30.395431068551964,
        30.36498912603321,
        30.30934969938757,
        30.22532746033711,
        30.14781496480586,
        30.10130238290126,
        30.08121719970835,
        30.077079332453117,
        30.096857477029364,
        30.116314223046594,
        30.137059169679617,
        30.15660745767018,
        30.174452368899995,
        30.190276197999044,
        30.197780788599495,
        30.197007196144682,
        30.20262185042286,
        30.214164149358787,
        30.241064537502734,
        30.27651739380359,
        30.3336899726265,
        30.408151380767627,
        30.48743508383968,
        30.553295047554275,
        30.621210486664133,
        30.678216483598256,
        30.72557487803395,
        30.743826876556664,
        30.73106733705156,
        30.705617892510055,
        30.685424851324353,
        30.673786466358813,
        30.67931121242693,
        30.700871726961328,
        30.741669981663257,
        30.775563200903044,
        30.800597940878355,
        30.83342910762014,
        30.89251786139595,
        30.98958548608698,
        31.148303272773138,
        31.333322561108826,
        31.532964100513823,
        31.721377953899424,
        31.879363055761768,
        31.998669055569348,
        32.07187578997634,
        32.1042561694257,
        32.09277189271196,
        32.02678653572584,
        31.920902821021752,
        31.78519714398277,
        31.631308905269726,
        31.46413544195476,
        31.317600908575848,
        31.186312843910464,
        31.08533863259248,
        31.015066453184158,
        30.985890295466287,
        30.989180854066756,
        31.03004381109302,
        31.097796273966043,
        31.16868676605165,
        31.255265090412024,
        31.359241549449003,
        31.474055982645858,
        31.608167646214433,
        31.762447024765113,
        31.943389033372945,
        32.112046862704275,
        32.25118883780163,
        32.32502934925615,
        32.29556770631534,
        32.16138173197692,
        31.946532240653074,
        31.670152137185816,
        31.360558992303112,
        31.093047251043327,
        30.89791955854809,
        30.795750936211107,
        30.817770579624856,
        30.980511306719485,
        31.280352901640203,
        31.729165864713742,
        32.30826715901483,
        32.97495661558217,
        33.58661264942569,
        34.01085807220336,
        34.19866598388235,
        34.112264579985805,
        33.76321530722892,
        33.202271813510734,
        32.60410248903985,
        32.156578152663556,
        31.872814202532062,
        31.830462197910386,
        32.14300992161592,
        32.81640399867481,
        33.83572651723577,
        35.10204914392988,
        36.376473934084274,
        37.531137347839156,
        38.40195801997683,
        38.80073855443708,
        38.73989570552353,
        38.313175476991766,
        37.64008477105905,
        36.895930874262184,
        36.13584158894378,
        35.52033914141059,
        35.11008349398969,
        34.899601577828875,
        34.91693777601854,
        35.15084294797849,
        35.479608516423724,
        35.890715017144416,
        36.30225190961604,
        36.68977921783295,
        37.08384452228184,
        37.47715000549245,
        37.8277749335674,
        38.130551455139646,
        38.41966330581731,
        38.699165888031345,
        38.97338896277175,
        39.24689939465407,
        39.52447592771075,
        39.81109445534899
      ]
    },
    "骨盆": {
      "mean": 21.471241163552094,
      "std": 1.6992793345648531,
      "cv": 7.914211021249286,
      "count": 141,
      "mean_diff": 0.1334329576760573,
      "max_diff": 0.6643118230940388,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.8498083790528652,
        "p_value": 1.112376507430627e-10,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 3,
        "rate": 2.127659574468085,
        "bounds": [
          17.15153506685938,
          25.67150992089404
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        19.869832198240932,
        19.80930254769134,
        19.79363724171348,
        19.816420865687178,
        19.871902608048984,
        19.954591998021215,
        20.058935925313698,
        20.17908674956437,
        20.30500126210043,
        20.434378290870704,
        20.555087560570374,
        20.670517087109285,
        20.763910461549518,
        20.837525146457043,
        20.886344493465053,
        20.908988391323767,
        20.88606950674751,
        20.8565139363617,
        20.827703137239535,
        20.81287984367767,
        20.79813120936607,
        20.78357234965872,
        20.784215977153256,
        20.798459623641598,
        20.827896467425763,
        20.860965026774732,
        20.87688858910893,
        20.88734311884891,
        20.884911109325316,
        20.865381103069087,
        20.82456859195388,
        20.786343455082815,
        20.738694956873793,
        20.693505535334683,
        20.641148123614453,
        20.58965705693165,
        20.54553387427069,
        20.501461633586096,
        20.465775502964792,
        20.425755844440395,
        20.380400442128035,
        20.346525637122376,
        20.32409241342399,
        20.31403437217002,
        20.311102136243658,
        20.317532016774113,
        20.32425888451727,
        20.33597023090471,
        20.338888635637467,
        20.340962817191638,
        20.34953587006472,
        20.36928661979437,
        20.396009358655494,
        20.427577405028455,
        20.463202618086203,
        20.520048100653902,
        20.595379775841835,
        20.70005671209477,
        20.828619196672676,
        20.9702858481649,
        21.11292602895608,
        21.237746879749558,
        21.327329301845673,
        21.37803516794926,
        21.389560227249508,
        21.362516533581342,
        21.296686127586106,
        21.21344468515797,
        21.11374691989698,
        21.008332379225394,
        20.901388235448746,
        20.811573284594875,
        20.730599192443485,
        20.654019805992778,
        20.579849127746975,
        20.48916635935353,
        20.383985906528057,
        20.265644375765014,
        20.13197251468842,
        19.993225094409944,
        19.872908068306536,
        19.786344797708335,
        19.716110809158824,
        19.66795078348342,
        19.618269185964706,
        19.560095337460922,
        19.495166145616288,
        19.444045321629233,
        19.411770410806323,
        19.394989317712295,
        19.422221773383463,
        19.51187869376796,
        19.66432914706806,
        19.87279362004495,
        20.157821275941174,
        20.52074191402718,
        20.960677156563293,
        21.450537817853526,
        21.99065386143661,
        22.465169658855082,
        22.801159297614383,
        22.96545228517363,
        22.94846478884588,
        22.761175415393257,
        22.47651935063104,
        22.21708330081787,
        22.00948816828844,
        21.893760269407476,
        21.9328771784981,
        22.16410256836247,
        22.571938449311414,
        23.124736357989995,
        23.789048181084034,
        24.403770642218596,
        24.951358932105506,
        25.329023509093954,
        25.449781746624073,
        25.30891817774414,
        24.998312487352468,
        24.59200157379305,
        24.127232338399764,
        23.710503900431146,
        23.378143016487925,
        23.1392904340212,
        22.982666157748803,
        22.937725934370075,
        22.993639459557887,
        23.117709293637425,
        23.310531025875427,
        23.517009468462383,
        23.732740072263542,
        23.971555305574945,
        24.242258050190774,
        24.5156449801949,
        24.800701847125666,
        25.07403286054759,
        25.32349435566431,
        25.536771739811982,
        25.701576905188706,
        25.80586866145497,
        25.838104836178722
      ]
    },
    "左上臂": {
      "mean": 30.90870325429655,
      "std": 2.660318408968801,
      "cv": 8.607020446899517,
      "count": 141,
      "mean_diff": 0.19303002467744215,
      "max_diff": 1.6317603212167668,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.7578349638203816,
        "p_value": 5.6627924243854875e-14,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 22,
        "rate": 15.602836879432624,
        "bounds": [
          25.99789781212776,
          34.173058313853645
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        31.575334131791415,
        31.39293227933108,
        31.2379425379368,
        31.107373125706438,
        30.999049883272317,
        30.91106411285522,
        30.84135466250911,
        30.787433904654712,
        30.746736201828433,
        30.721945269773915,
        30.699076602694895,
        30.673484391196972,
        30.63276341846956,
        30.55918079401302,
        30.45261294819763,
        30.32590002603705,
        30.176725774369906,
        30.009963502023844,
        29.85138742135581,
        29.718810433729328,
        29.611027031098036,
        29.51168487509533,
        29.438512675824136,
        29.37904820601404,
        29.320818255149096,
        29.257449927552592,
        29.175349136002033,
        29.080120188063415,
        28.980892375368132,
        28.87602747151389,
        28.770685774183583,
        28.67261916002379,
        28.593609942217903,
        28.54677333641423,
        28.534336793445835,
        28.558516347912235,
        28.613597700175262,
        28.687207799887965,
        28.7774171634577,
        28.871371783635503,
        28.946612597370358,
        28.991738871041225,
        29.002242601936832,
        28.981824549464033,
        28.94318993657936,
        28.899985927224197,
        28.87262346931667,
        28.88367794581705,
        28.919113634225898,
        28.977951019184275,
        29.063583000274967,
        29.17758396286296,
        29.318061173280483,
        29.474026434236,
        29.614330995120206,
        29.72084141849004,
        29.772973983172655,
        29.765400006963517,
        29.686700898809267,
        29.55523623797699,
        29.403039777970207,
        29.2496129511888,
        29.116764162528092,
        29.02946935528206,
        29.000873657690665,
        29.01923236505899,
        29.07002622686528,
        29.135442862134674,
        29.206390389760212,
        29.281140507052037,
        29.341342089487068,
        29.385750353704385,
        29.40818147312053,
        29.410359918816745,
        29.432430252478174,
        29.491146529393596,
        29.614095756180795,
        29.771609458636014,
        29.944206930227352,
        30.104528469590473,
        30.23541303872164,
        30.324475878470498,
        30.38503323239309,
        30.420077850260604,
        30.419792306145233,
        30.3882867031049,
        30.32293000163808,
        30.226491964874988,
        30.130870202065875,
        30.02309921729762,
        29.89830715642022,
        29.746486367596237,
        29.590177073694623,
        29.435837843415932,
        29.290765297018645,
        29.156787620957594,
        29.059323956446566,
        29.002348095724074,
        28.97141182203351,
        28.9386670144817,
        28.891621443947127,
        28.847983801129885,
        28.82056449395545,
        28.81177236182892,
        28.860556188777213,
        29.011043835163548,
        29.346990024172833,
        29.90510805864897,
        30.778891246077336,
        32.020746451692936,
        33.539197644164084,
        35.17095796538085,
        36.72252385809371,
        37.80266076436721,
        38.386375913190676,
        38.5045795696884,
        38.13018053083697,
        37.3042558161065,
        36.19559026997484,
        35.07349020402317,
        34.14129205077737,
        33.49131008304798,
        33.15948768080807,
        33.075949982175565,
        33.18618148180951,
        33.429066233139096,
        33.77117892936319,
        34.14762073276795,
        34.58731950007583,
        35.045357012929,
        35.44413458168261,
        35.743844493963756,
        35.94448633024605,
        36.07132028876365,
        36.13466072950123,
        36.172466191786626,
        36.201887042833434,
        36.24121781202737,
        36.310774651349874,
        36.434216605639435,
        36.64023384184881
      ]
    },
    "左前臂": {
      "mean": 23.90918612819183,
      "std": 1.6658364711119948,
      "cv": 6.967349127571397,
      "count": 141,
      "mean_diff": 0.2606261298778201,
      "max_diff": 1.9113587076960918,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.8258618047193558,
        "p_value": 1.2007607995934203e-11,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 7,
        "rate": 4.964539007092199,
        "bounds": [
          20.09629869798944,
          27.098232160676503
        ]
      },
      "outliers_zscore": {
        "count": 5,
        "rate": 3.546099290780142
      },
      "series_data": [
        27.09793259858646,
        26.288989707391142,
        25.75049942665093,
        25.400948492373058,
        25.17563512774736,
        25.026764970919658,
        24.9214866773927,
        24.838954162233478,
        24.765800024546927,
        24.703700251043195,
        24.64544292144011,
        24.582287680645077,
        24.509213848051555,
        24.404438564447418,
        24.27763850225022,
        24.12367737559377,
        23.927635410416748,
        23.71679009765569,
        23.528077328721473,
        23.381697685133922,
        23.288319808973643,
        23.250502063430794,
        23.27759335311587,
        23.348672123103132,
        23.44595473092059,
        23.549448526038944,
        23.639365386777026,
        23.711738695807057,
        23.765885167798736,
        23.799429083750034,
        23.81815841319034,
        23.83068887449973,
        23.8248969766798,
        23.789104529859465,
        23.720966527038662,
        23.62373732844714,
        23.53477657793109,
        23.434485880489383,
        23.36860328082734,
        23.32950486385343,
        23.31819579479926,
        23.342718210049213,
        23.40421119575191,
        23.495982039598626,
        23.620462968827,
        23.808966474605334,
        24.03273526822518,
        24.22897379594111,
        24.382326147274497,
        24.472507112168852,
        24.484344360066395,
        24.4084048892473,
        24.26330245125237,
        24.075175023108304,
        23.883137005390097,
        23.709306439978427,
        23.54953966575681,
        23.378030680780668,
        23.201786918987683,
        23.02719941570927,
        22.854348135323995,
        22.679550752044356,
        22.49770842033594,
        22.335294156973724,
        22.21512668209175,
        22.160864751816252,
        22.166958303532144,
        22.23130105945311,
        22.340050672473133,
        22.455888785555196,
        22.551111058533284,
        22.58071648810003,
        22.53015922104656,
        22.41314407151861,
        22.183624231774512,
        21.927400604408327,
        21.761663821057233,
        21.744207811149447,
        21.878290006924395,
        22.123334426993097,
        22.38875852042521,
        22.606556259166016,
        22.722023746497086,
        22.739284098652142,
        22.67078928722298,
        22.57636618948411,
        22.4976691921853,
        22.472691933521787,
        22.4889879526849,
        22.520574195683164,
        22.562367928944987,
        22.610890193687474,
        22.66890422764606,
        22.74276659841083,
        22.83745093786122,
        22.99125678897686,
        23.184841816422065,
        23.404255957059547,
        23.57186996657265,
        23.656113208420145,
        23.607287670207405,
        23.465054315904236,
        23.247567278670292,
        22.968535274423726,
        22.675559814967876,
        22.39967811714087,
        22.18494853615516,
        22.063049830590074,
        22.21296793887657,
        22.833765963901804,
        24.01405866940783,
        25.710412705687276,
        27.621771413383367,
        29.186907385094933,
        30.24841143675035,
        30.72982122909321,
        30.43741442347335,
        29.44624907052266,
        27.974369677242795,
        26.378005494477613,
        24.961160295616345,
        23.862446558917437,
        23.26702909315104,
        23.129108386649612,
        23.40573042783485,
        23.918716858955857,
        24.567482463820188,
        25.123231042372176,
        25.663988273031492,
        26.04429959452552,
        26.128042398445764,
        25.94987658108689,
        25.57425937187258,
        25.114517253218033,
        24.642219196587334,
        24.266311248442527,
        24.03595592128654,
        23.98878462887229,
        24.158802208371466,
        24.589019990685568,
        25.346514671412542
      ]
    },
    "左整臂": {
      "mean": 51.90963200573777,
      "std": 1.3116954895109394,
      "cv": 2.526882659013943,
      "count": 141,
      "mean_diff": 0.13913068949107402,
      "max_diff": 0.3599532294338488,
      "quality_level": "良好",
      "shapiro_test": {
        "statistic": 0.9716273926812057,
        "p_value": 0.004951500521298041,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          48.53403766743507,
          55.29505595243607
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        53.54623488384266,
        53.503624008835814,
        53.557069141860495,
        53.65134512302245,
        53.74963924459322,
        53.8291875608175,
        53.87731625668189,
        53.888077420849456,
        53.86459950157528,
        53.7863988862763,
        53.66052144692018,
        53.495659257732484,
        53.29453637297371,
        53.052186708912416,
        52.793776032510664,
        52.543783058990854,
        52.30989240724206,
        52.134616762584606,
        52.02727715873603,
        51.989631948742066,
        52.0196301769805,
        52.09706311762361,
        52.223397813933275,
        52.34721250560184,
        52.46448075996445,
        52.55737402830422,
        52.599476617612616,
        52.595738077678746,
        52.558831163265324,
        52.49026417040385,
        52.40215109449851,
        52.30907775114215,
        52.21093088971544,
        52.11073957769368,
        52.012691842202,
        51.924485403890344,
        51.88105730290673,
        51.84954937664969,
        51.86692543380675,
        51.91233097437214,
        51.96341006964705,
        52.019458238510786,
        52.07648117068821,
        52.129268613524665,
        52.19401023358489,
        52.31233049051673,
        52.4803484926977,
        52.665130107245865,
        52.83951899859862,
        52.98073462855763,
        53.07077870199532,
        53.10149030252495,
        53.09104356839252,
        53.052249562664905,
        52.98783004049682,
        52.89964124077197,
        52.7596740955607,
        52.54280297044365,
        52.247023836057416,
        51.908320156682215,
        51.556126687251925,
        51.20422538548981,
        50.86926258749186,
        50.58816324403231,
        50.37150548786184,
        50.21173206145782,
        50.08785796049939,
        49.98538841623621,
        49.89012224494718,
        49.8084098847252,
        49.74037680143114,
        49.697723773570964,
        49.70417747297187,
        49.778478338225575,
        49.91389180032015,
        50.115613427449006,
        50.391065855717606,
        50.72446508527326,
        51.08441831470711,
        51.43351973948235,
        51.738465252563365,
        51.97098209897856,
        52.13492749904431,
        52.23369350579544,
        52.25114134751466,
        52.21247824311945,
        52.13884315080696,
        52.061544398183784,
        52.01279381935507,
        51.97102448302303,
        51.928814441534826,
        51.871807927094395,
        51.81322597715948,
        51.75181227461949,
        51.68766596371306,
        51.636257016637465,
        51.62014398604695,
        51.64050265063855,
        51.63008961211854,
        51.580965802918286,
        51.47008838721913,
        51.311590035170276,
        51.100165772274956,
        50.83659369655083,
        50.57721478460142,
        50.329998164077,
        50.109786538363586,
        49.89854929188577,
        49.69733183849429,
        49.53130298188658,
        49.41198620125628,
        49.351799779151285,
        49.346517573619096,
        49.43430014397891,
        49.58620621326362,
        49.78251841251914,
        49.97956191151275,
        50.1625569919987,
        50.35229366949796,
        50.51784767762881,
        50.685986330948126,
        50.86469301195544,
        51.06941952431045,
        51.29596251971846,
        51.55014072904832,
        51.83030950236465,
        52.11967083387542,
        52.40194968727246,
        52.65661225573071,
        52.87316582324886,
        53.06113350863122,
        53.237489575903396,
        53.412911578963346,
        53.57579035137991,
        53.74344048447303,
        53.93001725177002,
        54.13327066939111,
        54.34720311661364,
        54.564145919690546,
        54.77749296611213,
        54.98506630155639
      ]
    },
    "右上臂": {
      "mean": 27.034586684554466,
      "std": 1.4593865050700596,
      "cv": 5.39822014702316,
      "count": 141,
      "mean_diff": 0.18148624708579894,
      "max_diff": 0.6388830645684607,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.9617029506249201,
        "p_value": 0.0005629960908178095,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 4,
        "rate": 2.8368794326241136,
        "bounds": [
          23.607897519624245,
          30.439103187240008
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        26.86791337251865,
        27.278399887001306,
        27.8082120976407,
        28.415951735122697,
        29.054834799691157,
        29.675773898482568,
        30.229934985131212,
        30.67076709158012,
        30.90436675188234,
        30.88223623992754,
        30.641773103044784,
        30.19466335725959,
        29.6464650743655,
        29.104091177088073,
        28.59950910933228,
        28.17707039361448,
        27.830967971238255,
        27.548106813928776,
        27.305620448966646,
        27.044122468193887,
        26.760328750846224,
        26.457150688045353,
        26.132660130505684,
        25.787642383170446,
        25.445152323897545,
        25.11898273795901,
        24.85034402383248,
        24.650628659503166,
        24.516828421047116,
        24.4411915961092,
        24.4269771181662,
        24.456922078307258,
        24.513235480839718,
        24.602651032027417,
        24.712860423154098,
        24.83624897395753,
        24.962928410065366,
        25.087816987913747,
        25.202502903471302,
        25.31284653389769,
        25.423208620446882,
        25.53925999945161,
        25.663992711491023,
        25.788449688186347,
        25.911957214021594,
        26.021687542011694,
        26.105620463169327,
        26.169599644980156,
        26.2098868924577,
        26.235492315503354,
        26.254970178663427,
        26.282628215693855,
        26.33198590241048,
        26.423348361446227,
        26.537911541177316,
        26.653008611136595,
        26.724234561150865,
        26.749353595342,
        26.729066383877704,
        26.676743529300342,
        26.61446278004326,
        26.56582559614887,
        26.530974560804953,
        26.520782484558254,
        26.533956735312024,
        26.562850137242112,
        26.591557695406614,
        26.62051404691858,
        26.645433440044417,
        26.66844255103569,
        26.68911774875128,
        26.730208216003795,
        26.811606268071934,
        26.938762955412443,
        27.12319723862805,
        27.36577430167493,
        27.66011519144133,
        27.98118124172849,
        28.307390694603395,
        28.6284300567663,
        28.906477088220377,
        29.12550242416388,
        29.275761580825428,
        29.321676047080995,
        29.286042735095045,
        29.17701282838336,
        28.98613802069541,
        28.737343580582785,
        28.471719319341286,
        28.180126582854417,
        27.877401061884097,
        27.575747316689995,
        27.29289077391153,
        27.04870924441545,
        26.840772364178395,
        26.695243448163126,
        26.61615618248455,
        26.604498746915652,
        26.734785770374422,
        26.999686639383107,
        27.35730143496341,
        27.775732186773972,
        28.22951004782403,
        28.64209344185708,
        28.934468239227396,
        29.089950285673023,
        29.10896038936819,
        28.981397270699016,
        28.72167697847388,
        28.424197629098376,
        28.066766800480043,
        27.771602887431563,
        27.564037346341557,
        27.438048952307263,
        27.323044022778085,
        27.198982297865093,
        27.07431397823642,
        26.932298768046145,
        26.790076305694498,
        26.666337232975952,
        26.571399820553886,
        26.53296968476647,
        26.536028768307496,
        26.56787737628901,
        26.635084850613545,
        26.70540750092916,
        26.73756287528517,
        26.701486994853433,
        26.597299576482936,
        26.433704318490648,
        26.21813899251162,
        25.978557484232766,
        25.771733608553927,
        25.614256359031213,
        25.53406776454721,
        25.53566135259777,
        25.601306034759897,
        25.69852473946333,
        25.78609487567399,
        25.82204706391868,
        25.77335388331668
      ]
    },
    "右前臂": {
      "mean": 21.142618659901075,
      "std": 3.748812537697111,
      "cv": 17.73107011009511,
      "count": 141,
      "mean_diff": 0.4631458127132423,
      "max_diff": 2.3718881354228465,
      "quality_level": "需改進",
      "shapiro_test": {
        "statistic": 0.9843944756940188,
        "p_value": 0.10965791889960186,
        "is_normal": true
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          11.15549816144713,
          31.551929794023536
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        19.93935165933553,
        18.610093114239383,
        17.588298309374213,
        16.82769845857393,
        16.284585737388742,
        15.920902112430587,
        15.706216651177007,
        15.618298824433818,
        15.62118803597049,
        15.764650338350824,
        16.044742997422773,
        16.423042000294004,
        16.885303505309615,
        17.315329100227352,
        17.743492286831763,
        18.07279822638034,
        18.330017350699965,
        18.576494346274945,
        18.76905026447068,
        18.92546064993864,
        18.975013085039773,
        18.94093406267391,
        18.869326600398825,
        18.804160023663282,
        18.782077242237193,
        18.761148027241724,
        18.76701918298132,
        18.715366062979456,
        18.75034792306709,
        18.7942869422858,
        18.924117150343623,
        19.204656609527888,
        19.583728931289805,
        20.030240877224408,
        20.466990715690795,
        20.9563021396013,
        21.500071315890544,
        22.05499200958266,
        22.690060896887097,
        23.353626234064937,
        24.05605429751514,
        24.755234220053193,
        25.577375256825043,
        26.335966493225538,
        27.08590144411799,
        27.826610348032027,
        28.43607245866329,
        28.761252668580482,
        28.862292194168738,
        28.754303722600934,
        28.38653372266399,
        27.75943183013796,
        26.939746706272246,
        25.947512611078157,
        24.917783739028245,
        23.95998540501004,
        23.15616042820549,
        22.452186058494668,
        21.974642537210944,
        21.698175573814048,
        21.5216148380876,
        21.350402681285253,
        21.20814048108304,
        21.035904843821736,
        20.765946141902255,
        20.40126441699516,
        19.949608592693714,
        19.54750987424052,
        19.306394590707036,
        19.205188172530136,
        19.247955827341983,
        19.376021147124305,
        19.57457553192935,
        19.805935479919818,
        20.031305777706653,
        20.220078679439094,
        20.379048627008473,
        20.504036744301022,
        20.534648985745584,
        20.463626243305335,
        20.311657856728694,
        20.145364163643926,
        20.000503344231973,
        19.864759186064934,
        19.78740156594598,
        19.774825798842357,
        19.903900643139057,
        20.218761165956998,
        20.726960156963813,
        21.432708323400593,
        22.30811832021879,
        23.226801485712464,
        23.6561980024282,
        23.585780618357912,
        23.00178513435058,
        21.82316539701079,
        20.04552729865059,
        17.79901776686839,
        15.427129631445542,
        13.506406857590147,
        12.325469385210235,
        11.833048973570149,
        11.865132537805106,
        12.323981801795998,
        13.260802292243,
        14.659031916538808,
        16.280261400873847,
        18.18352789912273,
        20.107199355539187,
        21.657365203475347,
        22.678565770934988,
        23.270820801657138,
        23.600994360528517,
        23.903267931807385,
        24.164022095083897,
        24.378564273028704,
        24.570383682439115,
        24.67224780104946,
        24.73448319848296,
        24.75795508034702,
        24.726403967010583,
        24.711447327116158,
        24.637824486543586,
        24.484801758651507,
        24.29975826325654,
        24.104638996069106,
        23.89116213589341,
        23.667149176555895,
        23.428334248622896,
        23.203908542891636,
        23.054252446810303,
        23.05754768094871,
        23.278690418099256,
        23.746797185903137,
        24.44718299636834,
        25.266855880963064,
        26.07508916560788,
        26.728116847558333,
        27.085538120234663,
        27.02391295864346,
        26.45201056855633
      ]
    },
    "右整臂": {
      "mean": 42.09873802984736,
      "std": 2.980375659824251,
      "cv": 7.079489313221717,
      "count": 141,
      "mean_diff": 0.3439809435710764,
      "max_diff": 1.7402244063706007,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.9670152130645304,
        "p_value": 0.0017526314491207496,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          31.732508801974923,
          51.89890854539454
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        43.249341682159894,
        43.29663802973203,
        43.48856287314914,
        43.79366862592623,
        44.18109690835318,
        44.618844902554244,
        45.07275129425442,
        45.5061554695044,
        45.80265076186326,
        45.97270314947587,
        46.039440927274065,
        45.95481476604989,
        45.79012433102532,
        45.548977860933675,
        45.3011310352748,
        45.03445355690245,
        44.776151239202974,
        44.56792063558747,
        44.360264211140105,
        44.092265843960334,
        43.70890653462257,
        43.22874402648791,
        42.675711771415536,
        42.06509221619933,
        41.44151869866755,
        40.79463590386228,
        40.21127923374259,
        39.691659213072256,
        39.29490870575728,
        38.97628009295479,
        38.77358950849647,
        38.68636022259095,
        38.695758780630584,
        38.8025166119368,
        38.96857871466226,
        39.19685264747307,
        39.469443326265,
        39.769083469475525,
        40.13534740850197,
        40.53292166157782,
        40.96301833629163,
        41.39843296733302,
        41.83692492157579,
        42.18554963386664,
        42.50172724266686,
        42.81170423246475,
        43.112409741004434,
        43.375155581426924,
        43.61855170743034,
        43.84506273313758,
        44.04347738563447,
        44.21605168741963,
        44.336508641612184,
        44.36531756526065,
        44.313548931475765,
        44.17751262526559,
        43.95603442103021,
        43.64471590335235,
        43.33270517592678,
        43.034224098016566,
        42.72742964517158,
        42.410832756249405,
        42.09133545973605,
        41.78397995215553,
        41.50583007599813,
        41.31346158266806,
        41.20534723157426,
        41.23909424124376,
        41.41128672931491,
        41.679573635616286,
        42.01168912942934,
        42.384220229120686,
        42.79380357586378,
        43.26332873452181,
        43.80320004954083,
        44.39403376856119,
        45.029870286919994,
        45.66960883586837,
        46.25258595140433,
        46.760831122574245,
        47.13563370244428,
        47.40334189402283,
        47.58202337321516,
        47.6154425729719,
        47.55420316584423,
        47.395922466137606,
        47.17006716289275,
        46.94060500449865,
        46.77020249368286,
        46.66951394890988,
        46.66302280627569,
        46.693665833783584,
        46.4523639974642,
        45.95535383125535,
        45.113987767805,
        43.972649640440245,
        42.50881178113387,
        40.77261336086331,
        39.03238895449271,
        37.56736155807329,
        36.512258612284654,
        35.93038722712475,
        35.88621642302757,
        36.3699390437524,
        37.324237952421285,
        38.58934043819751,
        39.77111955530293,
        40.97672085522437,
        41.930058614670024,
        42.41842323279941,
        42.258502288557615,
        41.75271735607307,
        41.13161828883863,
        40.7028226410196,
        40.38886779062524,
        40.124629720931445,
        39.94136126021459,
        39.77883285043591,
        39.639964110714715,
        39.50639035081594,
        39.370701824740685,
        39.289333368801216,
        39.19902580913573,
        39.07783031676,
        38.96567775786409,
        38.90097464745165,
        38.85169037660953,
        38.806558725610174,
        38.747203786484114,
        38.672856705006126,
        38.59202592975674,
        38.51619128540123,
        38.458933597428896,
        38.417209169355274,
        38.3950290004498,
        38.37927374328895,
        38.357011190475404,
        38.31421966435509,
        38.23886782785743,
        38.124727058834246,
        37.97601311513171
      ]
    },
    "左大腿": {
      "mean": 41.20792951180151,
      "std": 1.045874761078901,
      "cv": 2.5380424919902214,
      "count": 141,
      "mean_diff": 0.09170706349923315,
      "max_diff": 0.2724294427921379,
      "quality_level": "良好",
      "shapiro_test": {
        "statistic": 0.9621574464718009,
        "p_value": 0.0006189181370666548,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 6,
        "rate": 4.25531914893617,
        "bounds": [
          39.05734930827116,
          43.41517616155012
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        40.34548767381798,
        40.37333836210873,
        40.405296826619434,
        40.42861395461174,
        40.43993518364861,
        40.44198009976304,
        40.440786751912405,
        40.443502001774725,
        40.467643197669744,
        40.49691304120284,
        40.544344935043654,
        40.608230368133455,
        40.691534378250765,
        40.791602516485824,
        40.88341095407856,
        40.96461727197998,
        41.02800123076666,
        41.07235773866884,
        41.0975638961958,
        41.11336839605751,
        41.115924472778474,
        41.11882317546952,
        41.14254546941052,
        41.1775259914392,
        41.24268495973061,
        41.33747142195362,
        41.466089878316374,
        41.60236718690372,
        41.732654382762675,
        41.829597036897454,
        41.8698450393942,
        41.84324791087619,
        41.76335606126034,
        41.62858234345902,
        41.46615306181168,
        41.30176839351626,
        41.16153391853769,
        41.039478320840786,
        40.9707805923404,
        40.946047227618465,
        40.96528656748015,
        41.01210393361574,
        41.08564760819668,
        41.17856090128019,
        41.27417106033748,
        41.36027893660587,
        41.41999745718989,
        41.43097704977377,
        41.41198537135308,
        41.36862322157553,
        41.30923005191521,
        41.248047287100206,
        41.1941687807388,
        41.15345073153106,
        41.137029221695585,
        41.12179370737755,
        41.132624699436526,
        41.1644686520293,
        41.19754896622681,
        41.24118739977585,
        41.29536629574257,
        41.369876980531295,
        41.46492448745986,
        41.576599913665156,
        41.6961757084846,
        41.810577076565544,
        41.87818620223482,
        41.89922289092243,
        41.86842163769214,
        41.780991091570506,
        41.6565511760574,
        41.49398023000249,
        41.29593812285392,
        41.08172059152351,
        40.84063791364646,
        40.577342512738156,
        40.30491306994602,
        40.04687128784183,
        39.795682680714904,
        39.55329317117956,
        39.333143282837774,
        39.15326646504947,
        39.016792194540955,
        38.93489107356963,
        38.8986419254688,
        38.905773549032816,
        38.95229509079921,
        39.03244888569536,
        39.112795763352985,
        39.1858457729082,
        39.269718622096505,
        39.391773826340895,
        39.52525838908559,
        39.67186604148814,
        39.86655731036556,
        40.092932736902064,
        40.338044556107214,
        40.58329223178838,
        40.79132516030268,
        40.953433281796336,
        41.06734839330012,
        41.128583578570016,
        41.12208645443116,
        41.0596029964486,
        40.974055465690824,
        40.91021314762382,
        40.856558137757084,
        40.85006750215065,
        40.909546378142565,
        41.018106363184266,
        41.173733618140275,
        41.36038719977624,
        41.56291563483401,
        41.79550332571444,
        42.04245692029484,
        42.27337231078202,
        42.47276847742001,
        42.630083454658426,
        42.74458745907906,
        42.81191242714088,
        42.83314590931142,
        42.84323312197633,
        42.80278290295393,
        42.733515362039526,
        42.6435875854207,
        42.56507115390287,
        42.514933565396895,
        42.503429433759315,
        42.513013938514376,
        42.54369022401292,
        42.60490026463747,
        42.69374795030005,
        42.80780842242783,
        42.92688015618901,
        43.055029553581576,
        43.168872123311075,
        43.25658020648598,
        43.306439003611274,
        43.3078495078732,
        43.2527321866625,
        43.137372916261
      ]
    },
    "左小腿": {
      "mean": 44.20675987480207,
      "std": 3.1198947330609985,
      "cv": 7.057506005635451,
      "count": 141,
      "mean_diff": 0.30619371199338097,
      "max_diff": 1.398534979112803,
      "quality_level": "可接受",
      "shapiro_test": {
        "statistic": 0.9320142361429403,
        "p_value": 2.6330936471023925e-06,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          32.942139174415956,
          54.551910299905984
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        39.03990210107087,
        40.33530406633385,
        41.66617758925095,
        42.950031804620195,
        44.126519808175104,
        45.1527164005166,
        45.99910888161635,
        46.64648575035223,
        47.08476551489079,
        47.218753105474164,
        47.115803438255234,
        46.836573188018775,
        46.50426224595701,
        46.19415238498763,
        45.907714803303506,
        45.70561982894141,
        45.63120747373402,
        45.66352739893552,
        45.791351895895296,
        45.98673116878352,
        46.226747963693256,
        46.44824612784723,
        46.686738463068735,
        46.870780495007025,
        46.96896762934989,
        46.98799035466271,
        46.90833929983645,
        46.70373005316496,
        46.39421203452372,
        46.01832551982052,
        45.61751549518995,
        45.22690208900984,
        44.79836916863303,
        44.35916165142804,
        43.910674902322555,
        43.48133259217116,
        43.1641487371367,
        42.87883965467542,
        42.66027933899994,
        42.549147410022435,
        42.50023960653363,
        42.52060224026904,
        42.633953191042366,
        42.8377516347377,
        43.14998731290051,
        43.56742089132388,
        43.98154207368638,
        44.41331209640707,
        44.80864889435368,
        45.198648483695735,
        45.596747187676755,
        45.893833354257445,
        46.14157023723139,
        46.33260164107509,
        46.41382148343005,
        46.480911719045665,
        46.52014679533532,
        46.51949124586811,
        46.53945706880843,
        46.52927053866317,
        46.45814957772437,
        46.30458754811949,
        46.11177808022888,
        45.94708929208014,
        45.852384207310855,
        45.767297586938284,
        45.728499503731214,
        45.70420737334511,
        45.70551889286617,
        45.774121046506274,
        45.80602067079548,
        45.806616158073346,
        45.80888914370092,
        45.775037989270835,
        45.734813581743126,
        45.688100090653435,
        45.78195933064224,
        46.058021842481864,
        46.58180039181348,
        47.24916663966869,
        47.98723833928933,
        48.704886980150214,
        49.34157764167765,
        49.802139483382796,
        50.11615809602545,
        50.270582425779494,
        50.25890787626274,
        50.10147522580332,
        49.86438986424144,
        49.60937809277695,
        49.367772823608576,
        49.07023607823013,
        48.68694326679392,
        48.08903025905988,
        47.19589184602889,
        46.02472536949328,
        44.66788965812716,
        43.269354679014356,
        42.073777474579984,
        41.0488845283069,
        40.292080943329,
        39.85192629670597,
        39.719501774188146,
        39.88276375377272,
        40.281855847376534,
        40.79916125316852,
        41.38445386034813,
        41.88917502206482,
        42.211380776785546,
        42.29208788716984,
        42.13937089429526,
        41.84461832882993,
        41.48432874521601,
        41.04580334647472,
        40.65579481290298,
        40.362288035319956,
        40.14311417226276,
        40.01517202715629,
        39.94168089818009,
        39.91113348668041,
        39.93041312606278,
        39.9577449098099,
        40.0103343081345,
        40.06855972366374,
        40.136210676254564,
        40.22752409041778,
        40.30168539287075,
        40.34894776801312,
        40.38488858074609,
        40.39537985876006,
        40.352118901850005,
        40.26412353460763,
        40.11976950028658,
        39.94165156543641,
        39.727928065807,
        39.514872107571655,
        39.314497586690706,
        39.13663140060048,
        38.989183342709005,
        38.87878186499428,
        38.811789397231934
      ]
    },
    "左整腿": {
      "mean": 84.04231767247073,
      "std": 2.0285480657918726,
      "cv": 2.4137221842185737,
      "count": 141,
      "mean_diff": 0.23264285045845565,
      "max_diff": 1.2552529653145683,
      "quality_level": "良好",
      "shapiro_test": {
        "statistic": 0.9599673153853295,
        "p_value": 0.00039375094479140776,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          77.27444734544254,
          90.87033324741613
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        78.98272946416864,
        80.23798242948321,
        81.49275305148595,
        82.66233249095704,
        83.69213196509594,
        84.5506313621865,
        85.22350580382088,
        85.70891163519752,
        86.03491381136683,
        86.10253180090051,
        86.00627369741878,
        85.80211356966439,
        85.60875450655274,
        85.48242179127985,
        85.38600349488198,
        85.36348257141375,
        85.44167562377694,
        85.58459384760599,
        85.78273153239012,
        86.01775339619721,
        86.27439389797027,
        86.51863393865577,
        86.8041918949592,
        87.053141602921,
        87.26922227183152,
        87.45173186822758,
        87.58885504259952,
        87.61403699601324,
        87.52723933042853,
        87.32806447453483,
        87.02419674862344,
        86.6380169821108,
        86.14802406689158,
        85.57611363950411,
        84.96103709720443,
        84.35828496889273,
        83.88124956596803,
        83.4565013296341,
        83.16564072026112,
        83.03455617399727,
        83.02686169807616,
        83.1194759577894,
        83.33076836505043,
        83.64215620034935,
        84.0475336037538,
        84.5276584808566,
        84.9646526586611,
        85.34618749288911,
        85.65151462495955,
        85.90804418327195,
        86.13328644825108,
        86.26181358613758,
        86.35206498424147,
        86.41321780572392,
        86.4187500908783,
        86.40606608789821,
        86.40604037377298,
        86.39034313960966,
        86.37983278971856,
        86.3343680971697,
        86.23777163235201,
        86.09671816261758,
        85.94857451459612,
        85.82773248791503,
        85.78173931156229,
        85.77187603417603,
        85.743879588094,
        85.6782115263301,
        85.57758351886896,
        85.45740032564095,
        85.28526814820876,
        85.0339136288667,
        84.73047682310855,
        84.37689222478626,
        83.99736575663624,
        83.59876261930557,
        83.28257240293932,
        83.11217306188487,
        83.16486000779194,
        83.34172243282342,
        83.54562483703319,
        83.76028739620406,
        84.01467909515793,
        84.27102354791427,
        84.53562765382132,
        84.76466796028052,
        84.96149878091127,
        85.1030558411737,
        85.1720517471848,
        85.21213560789487,
        85.2321339698389,
        85.19045090295785,
        85.04223893895286,
        84.69165645595912,
        84.12076251180741,
        83.37670244234864,
        82.56858611445564,
        81.77392141466629,
        81.11122373300375,
        80.55738807224306,
        80.16106510042793,
        79.92486887184978,
        79.83299417750993,
        79.90702866701564,
        80.11847103313696,
        80.42496739220765,
        80.7902150722074,
        81.17082721517751,
        81.50580857250642,
        81.73625087111643,
        81.87182768243656,
        81.94953883492418,
        82.0029350930993,
        82.02955958153218,
        82.07514622400946,
        82.13970356223126,
        82.20093620728402,
        82.2759054362751,
        82.33966738126352,
        82.38777153178695,
        82.43424882482756,
        82.47309806397895,
        82.47777922021773,
        82.45049596940268,
        82.40104355188068,
        82.37290455868263,
        82.35461297897623,
        82.35575629249202,
        82.37119001434948,
        82.39208608915035,
        82.40917393626796,
        82.42701837395994,
        82.43123059493712,
        82.41343118200776,
        82.37144648276693,
        82.30756009065809,
        82.22032846987562,
        82.10859052531775,
        81.97151269757852,
        81.8086391931023,
        81.61994784149725
      ]
    },
    "右大腿": {
      "mean": 42.4059939838453,
      "std": 0.6389942718926058,
      "cv": 1.5068489424774072,
      "count": 141,
      "mean_diff": 0.07660475167002027,
      "max_diff": 0.4387026309984776,
      "quality_level": "優秀",
      "shapiro_test": {
        "statistic": 0.8740749815450584,
        "p_value": 1.3676047986562447e-09,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 9,
        "rate": 6.382978723404255,
        "bounds": [
          40.83107725607266,
          43.746311964845916
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        41.63862486331495,
        42.07732749431343,
        42.48525714610815,
        42.815507433491334,
        43.0469631261017,
        43.176808172862316,
        43.214586560873684,
        43.17756524474756,
        43.104114513483026,
        42.99417656359228,
        42.87573177496258,
        42.75534064108601,
        42.653098949055945,
        42.60136557514082,
        42.543213207219765,
        42.49256795615997,
        42.445485216455246,
        42.40146823905956,
        42.347096312274566,
        42.27281606779472,
        42.19982656424617,
        42.13872453466521,
        42.09240671018113,
        42.04949936805871,
        42.01774884119849,
        41.99220606679074,
        41.9709357230343,
        41.96015131253491,
        41.94371955254708,
        41.91166992397844,
        41.854931500075075,
        41.784495994926985,
        41.70736376340727,
        41.64075393281155,
        41.604048241773626,
        41.60116292387944,
        41.63565059891947,
        41.695037687899614,
        41.75990420941705,
        41.820867768553725,
        41.87071153797357,
        41.912543790805564,
        41.938215125973045,
        41.95382485489852,
        41.95575389736266,
        41.94390286633316,
        41.92429027186263,
        41.89926958870093,
        41.86290400248386,
        41.8196873915733,
        41.79755444018665,
        41.79771614888692,
        41.8198539144828,
        41.88251691194086,
        41.98603693611964,
        42.12014855814734,
        42.268113337187366,
        42.428972117092385,
        42.590149172262635,
        42.771554107066656,
        42.98050909612439,
        43.21418456394832,
        43.451001622269274,
        43.683415910134144,
        43.90867466929106,
        44.08458743885306,
        44.20011414776923,
        44.27073929028694,
        44.28859978150204,
        44.262272382944346,
        44.18760208926034,
        44.0696916857505,
        43.911024628296005,
        43.72638213230859,
        43.49166849321341,
        43.19392455296903,
        42.878597540335576,
        42.575661642431115,
        42.30065827105507,
        42.079643500651635,
        41.93464983876821,
        41.86312686518137,
        41.82796203074385,
        41.837536252937156,
        41.850588456071634,
        41.85773612020175,
        41.86454851386266,
        41.86544697406676,
        41.822545137664434,
        41.72664919692496,
        41.656168461492435,
        41.62936424053951,
        41.64888578167216,
        41.72748462627716,
        41.85741295093503,
        41.99593786886847,
        42.11884214688302,
        42.22511885601288,
        42.262727476244315,
        42.28600154698745,
        42.317650854552184,
        42.34372904873265,
        42.34369779520261,
        42.32500900885815,
        42.322947202179186,
        42.32454077341707,
        42.321910887967306,
        42.321147034892704,
        42.31808094167238,
        42.2891515014587,
        42.24841506440402,
        42.19883962875194,
        42.146157348302026,
        42.12835973680423,
        42.14581138018791,
        42.178681564840794,
        42.223104951393495,
        42.27139229399439,
        42.31034517293924,
        42.334927471732755,
        42.35121854399445,
        42.3625272982098,
        42.36602029663028,
        42.37261506952669,
        42.38829422819285,
        42.403579042114686,
        42.425311186993795,
        42.45125662098193,
        42.48780556055597,
        42.52701551176138,
        42.568666843123246,
        42.60696330037431,
        42.63558148435807,
        42.654709150389365,
        42.67198167869924,
        42.69406650963854,
        42.72429125601615,
        42.765948606986036,
        42.82233001833464,
        42.89676664908282,
        42.992677173873794
      ]
    },
    "右小腿": {
      "mean": 41.260521836961104,
      "std": 1.3866818941308914,
      "cv": 3.3607958222397087,
      "count": 141,
      "mean_diff": 0.12188749941495293,
      "max_diff": 0.4544695495371087,
      "quality_level": "良好",
      "shapiro_test": {
        "statistic": 0.9469847302095753,
        "p_value": 3.27779137828718e-05,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          37.85846399703708,
          44.5260553381281
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        42.838483741272334,
        42.68978395473165,
        42.60243964215287,
        42.561751348614976,
        42.55460839510572,
        42.569063527475556,
        42.593985599792276,
        42.618805349821606,
        42.63565938970295,
        42.61825948233111,
        42.54099745750936,
        42.4179646227559,
        42.290075260899734,
        42.176292380972725,
        42.01634810771874,
        41.869454982128914,
        41.73727275467767,
        41.651413982446826,
        41.589658542666776,
        41.55602265543929,
        41.504270957226026,
        41.436683887077244,
        41.35258455845336,
        41.253212819347645,
        41.11535720652493,
        40.962699335633324,
        40.80302711379593,
        40.63181721402428,
        40.48087251256127,
        40.37524652152865,
        40.33256202694058,
        40.358810749946215,
        40.398718307935724,
        40.49187294910696,
        40.604352107149104,
        40.709086738658975,
        40.80520633711238,
        40.91201664393901,
        40.98013815927892,
        41.01280260590753,
        40.98515052121077,
        40.89739795863018,
        40.77000859460708,
        40.61830655402731,
        40.48123945762322,
        40.36053383856384,
        40.227528173705984,
        40.170977133864774,
        40.10768289484969,
        40.01092282429334,
        39.92985320753438,
        39.88176655212178,
        39.87363182665747,
        39.88476808014005,
        39.87011727672716,
        39.82407875094522,
        39.754520848273685,
        39.67408641204278,
        39.61590139381318,
        39.56356205053679,
        39.50754165264047,
        39.46442329542105,
        39.38259389675949,
        39.27886288538629,
        39.224542677788044,
        39.22939039794791,
        39.289164425171336,
        39.3486366698273,
        39.384458103790045,
        39.38898560669211,
        39.37370951770747,
        39.34636400156574,
        39.314184937543956,
        39.282150849263736,
        39.281315585636726,
        39.32298364983397,
        39.420758362052894,
        39.57063925622206,
        39.81816363030435,
        40.11432233156474,
        40.40789694625448,
        40.66728668548281,
        40.84015682864051,
        40.89301582941322,
        40.88589570482026,
        40.82939810008001,
        40.73762636078139,
        40.65294271226132,
        40.60636473945827,
        40.609618038820685,
        40.66896178041579,
        40.76243877220566,
        41.00839408145115,
        41.31863792960689,
        41.61124617489553,
        41.84873497925729,
        41.974193798636485,
        41.993905600306654,
        41.96969719658397,
        41.873587443113514,
        41.71934226415507,
        41.551072696173485,
        41.37326564627959,
        41.233072032745575,
        41.17222502314269,
        41.2603634189812,
        41.56060810933989,
        41.83665370369273,
        42.02570858521897,
        42.104142804883864,
        42.043800667848586,
        41.86460490541743,
        41.58944893827159,
        41.25867905175315,
        40.920801153673736,
        40.65176681898032,
        40.46894605417096,
        40.43836102927425,
        40.58882242122016,
        40.93527354476552,
        41.386843759033084,
        41.829300950299924,
        42.28377049983703,
        42.70061171589171,
        43.0556117074957,
        43.37572263715778,
        43.649775875728395,
        43.870464130094376,
        44.03164948281923,
        44.15888484552703,
        44.244691809523886,
        44.31326692368229,
        44.367592138084056,
        44.4000255984311,
        44.363496555912384,
        44.288942760867116,
        44.178234951449994,
        44.03376036284695,
        43.85861554144675,
        43.6568299331315,
        43.4336222461264
      ]
    },
    "右整腿": {
      "mean": 82.51582724330093,
      "std": 1.7337519288078356,
      "cv": 2.1011144003874613,
      "count": 141,
      "mean_diff": 0.13162442260678567,
      "max_diff": 0.5731431721859508,
      "quality_level": "良好",
      "shapiro_test": {
        "statistic": 0.9195587251869455,
        "p_value": 4.0272580220960336e-07,
        "is_normal": false
      },
      "outliers_iqr": {
        "count": 0,
        "rate": 0.0,
        "bounds": [
          78.11862771845907,
          87.24844391796202
        ]
      },
      "outliers_zscore": {
        "count": 0,
        "rate": 0.0
      },
      "series_data": [
        83.8247628431484,
        84.39790601533436,
        84.87254590798769,
        85.24209972955879,
        85.50640034558805,
        85.67014067936046,
        85.7415679957767,
        85.73138333130771,
        85.67144252991699,
        85.53603848800878,
        85.33108146594785,
        85.07777574902326,
        84.8367975373829,
        84.66400047025765,
        84.44082740091622,
        84.23914419928877,
        84.05695331777747,
        83.92320129229925,
        83.79983739765014,
        83.67456303180867,
        83.53105856735957,
        83.38659352010805,
        83.24803751023926,
        83.10546144853089,
        82.94880963816905,
        82.78852181652968,
        82.62585486083216,
        82.46384215242621,
        82.3096231393093,
        82.17407070114983,
        82.05983125612707,
        81.97990694744884,
        81.88170334423317,
        81.8069958140927,
        81.74618841615543,
        81.68153286517685,
        81.63733346417295,
        81.62402098370374,
        81.622797774918,
        81.63436732718148,
        81.6452910080956,
        81.64873203640279,
        81.6291660782803,
        81.58615724952521,
        81.53309548101856,
        81.47555293624575,
        81.38697900865637,
        81.33973672385146,
        81.2774735720513,
        81.18711771441914,
        81.13511749787097,
        81.13873306651178,
        81.21100910651305,
        81.343001290456,
        81.49111457484703,
        81.61781607598544,
        81.71128435907221,
        81.77811742742165,
        81.83203040039531,
        81.87866229123354,
        81.91939720243131,
        81.98657193814148,
        82.0367962621265,
        82.08142904761864,
        82.17716343179343,
        82.30702278294316,
        82.44833330427636,
        82.56646139832043,
        82.63316489465971,
        82.62449274293155,
        82.53705208367464,
        82.36401768278836,
        82.11062156886562,
        81.80749536981561,
        81.47564435301697,
        81.13335006113532,
        80.81500273933726,
        80.55648511791804,
        80.39964115006414,
        80.30872103659742,
        80.26585929107335,
        80.25461117986403,
        80.23890173188785,
        80.19230793785353,
        80.09803202964329,
        79.95606259386233,
        79.79638809544439,
        79.66200481288604,
        79.55605034974462,
        79.48240189261638,
        79.49761623720677,
        79.59984481552453,
        79.8236045885672,
        80.11425682805327,
        80.46653991196013,
        80.82766765751963,
        81.15436442421807,
        81.42595199464475,
        81.61634903089937,
        81.73725340842712,
        81.7942304598172,
        81.79024790069896,
        81.71816491185197,
        81.62407156200226,
        81.55240775411193,
        81.54230879327267,
        81.64804476771792,
        81.75553945515335,
        81.86143037271476,
        81.9336974740816,
        81.97070671424696,
        81.96822421861236,
        81.93261071368353,
        81.89032352212372,
        81.85054348718175,
        81.8337944962971,
        81.85166983306898,
        81.95487485983986,
        82.15586832579478,
        82.47386514577843,
        82.84409437644862,
        83.18736688306439,
        83.52473396102401,
        83.83144893736751,
        84.10134638689391,
        84.34879305244513,
        84.59035837372544,
        84.8134791192833,
        85.01557494372925,
        85.19772129082398,
        85.35203413846189,
        85.4921308756277,
        85.61161009554556,
        85.70049363480287,
        85.72789105826268,
        85.72962318263237,
        85.71091167081917,
        85.6772914536475,
        85.6347932152742,
        85.59015008306883,
        85.55102764902284
      ]
    }
  },
  "symmetry_analysis": [
    {
      "pair_name": "上臂",
      "left_mean_cm": 30.90870325429655,
      "right_mean_cm": 27.034586684554466,
      "difference_cm": 3.8741165697420854,
      "difference_percent": 13.372097351843626,
      "assessment": "[X] 不對稱",
      "left_cv": 8.607020446899517,
      "right_cv": 5.39822014702316
    },
    {
      "pair_name": "前臂",
      "left_mean_cm": 23.90918612819183,
      "right_mean_cm": 21.142618659901075,
      "difference_cm": 2.7665674682907557,
      "difference_percent": 12.281716487513297,
      "assessment": "[X] 不對稱 (右側不穩 CV:17.7%)",
      "left_cv": 6.967349127571397,
      "right_cv": 17.73107011009511
    },
    {
      "pair_name": "整臂",
      "left_mean_cm": 51.90963200573777,
      "right_mean_cm": 42.09873802984736,
      "difference_cm": 9.810893975890409,
      "difference_percent": 20.872383963633613,
      "assessment": "[X] 不對稱",
      "left_cv": 2.526882659013943,
      "right_cv": 7.079489313221717
    },
    {
      "pair_name": "大腿",
      "left_mean_cm": 41.20792951180151,
      "right_mean_cm": 42.4059939838453,
      "difference_cm": 1.1980644720437894,
      "difference_percent": 2.865705667085851,
      "assessment": "[!] 可接受",
      "left_cv": 2.5380424919902214,
      "right_cv": 1.5068489424774072
    },
    {
      "pair_name": "小腿",
      "left_mean_cm": 44.20675987480207,
      "right_mean_cm": 41.260521836961104,
      "difference_cm": 2.9462380378409634,
      "difference_percent": 6.894423173015135,
      "assessment": "[X] 不對稱",
      "left_cv": 7.057506005635451,
      "right_cv": 3.3607958222397087
    },
    {
      "pair_name": "整腿",
      "left_mean_cm": 84.04231767247073,
      "right_mean_cm": 82.51582724330093,
      "difference_cm": 1.5264904291697974,
      "difference_percent": 1.8329820255163654,
      "assessment": "[OK] 對稱",
      "left_cv": 2.4137221842185737,
      "right_cv": 2.1011144003874613
    }
  ],
  "body_height_analysis": {
    "sample_count": 141,
    "mean_cm": 155.6779686579269,
    "std_cm": 3.068603824023625,
    "cv_percent": 1.971122728846948,
    "min_cm": 149.81948888680773,
    "max_cm": 161.101453954787,
    "max_mean_ratio": 1.034837847279323,
    "assessment": "[OK] 身高比例穩定（幾乎沒有 scaling 漂移）",
    "scale_warning": null
  },
  "joint_depth_stability": {
    "nose": {
      "sample_count": 141,
      "mean_z_cm": 223.4930413422958,
      "std_z_cm": 2.249313836714803,
      "cv_percent": 1.0064357365247072,
      "min_z_cm": 217.93359260322958,
      "max_z_cm": 229.22281216817987
    },
    "left_shoulder": {
      "sample_count": 141,
      "mean_z_cm": 245.32021151314186,
      "std_z_cm": 7.505701201383095,
      "cv_percent": 3.0595527189087774,
      "min_z_cm": 235.65876792864293,
      "max_z_cm": 260.73874250623504
    },
    "right_shoulder": {
      "sample_count": 141,
      "mean_z_cm": 245.83266650275016,
      "std_z_cm": 5.489662259986115,
      "cv_percent": 2.2330890105382726,
      "min_z_cm": 235.853637788367,
      "max_z_cm": 260.8610819250392
    },
    "left_hip": {
      "sample_count": 141,
      "mean_z_cm": 248.4205650566254,
      "std_z_cm": 4.690721142199428,
      "cv_percent": 1.8882177251026773,
      "min_z_cm": 237.8933558298066,
      "max_z_cm": 255.9807896116393
    },
    "right_hip": {
      "sample_count": 141,
      "mean_z_cm": 247.45099767153056,
      "std_z_cm": 5.522358742320084,
      "cv_percent": 2.2316979096000775,
      "min_z_cm": 236.16312705046226,
      "max_z_cm": 257.67594612074447
    },
    "left_wrist": {
      "sample_count": 141,
      "mean_z_cm": 245.49255465563152,
      "std_z_cm": 5.524920120594491,
      "cv_percent": 2.250544880411814,
      "min_z_cm": 236.03844679497973,
      "max_z_cm": 260.13707934652206
    },
    "right_wrist": {
      "sample_count": 141,
      "mean_z_cm": 233.36652609441845,
      "std_z_cm": 9.420248084549371,
      "cv_percent": 4.036674943148447,
      "min_z_cm": 213.79615392662018,
      "max_z_cm": 252.82698294269454
    },
    "left_ankle": {
      "sample_count": 141,
      "mean_z_cm": 263.6724003687075,
      "std_z_cm": 3.458680026883114,
      "cv_percent": 1.3117338113684456,
      "min_z_cm": 251.97131596740533,
      "max_z_cm": 269.96695567408204
    },
    "right_ankle": {
      "sample_count": 141,
      "mean_z_cm": 252.26632373361434,
      "std_z_cm": 3.0248064061146454,
      "cv_percent": 1.1990527952152463,
      "min_z_cm": 246.53930008180447,
      "max_z_cm": 258.31632161533537
    }
  },
  "joint_angle_analysis": {
    "left_elbow": {
      "sample_count": 141,
      "mean_angle_deg": 149.34154053054434,
      "std_angle_deg": 19.94059562765384,
      "min_angle_deg": 91.24394910379637,
      "max_angle_deg": 170.34319498701197,
      "abnormal_count": 0,
      "abnormal_rate": 0.0,
      "abnormal_details": []
    },
    "right_elbow": {
      "sample_count": 141,
      "mean_angle_deg": 124.87888611978656,
      "std_angle_deg": 18.637515457529638,
      "min_angle_deg": 92.31708708822978,
      "max_angle_deg": 159.88079162532264,
      "abnormal_count": 0,
      "abnormal_rate": 0.0,
      "abnormal_details": []
    },
    "left_knee": {
      "sample_count": 141,
      "mean_angle_deg": 160.89567928054174,
      "std_angle_deg": 7.483113572279145,
      "min_angle_deg": 143.18936348157115,
      "max_angle_deg": 169.82134103731423,
      "abnormal_count": 0,
      "abnormal_rate": 0.0,
      "abnormal_details": []
    },
    "right_knee": {
      "sample_count": 141,
      "mean_angle_deg": 162.62774976723566,
      "std_angle_deg": 7.818105775760886,
      "min_angle_deg": 149.16602198718084,
      "max_angle_deg": 175.5394960937249,
      "abnormal_count": 0,
      "abnormal_rate": 0.0,
      "abnormal_details": []
    }
  },
  "bone_orientation_stability": {
    "左上臂": {
      "sample_count": 140,
      "mean_angle_change_deg": 0.9329604595318015,
      "max_angle_change_deg": 4.170058835421105,
      "std_angle_change_deg": 0.9119911258959876
    },
    "右上臂": {
      "sample_count": 140,
      "mean_angle_change_deg": 1.5590455775665721,
      "max_angle_change_deg": 3.8852805628437896,
      "std_angle_change_deg": 0.861978988910921
    },
    "左大腿": {
      "sample_count": 140,
      "mean_angle_change_deg": 0.4919510986285433,
      "max_angle_change_deg": 1.4540868417952928,
      "std_angle_change_deg": 0.2649005351444987
    },
    "右大腿": {
      "sample_count": 140,
      "mean_angle_change_deg": 0.5607122021676978,
      "max_angle_change_deg": 2.9660549183968605,
      "std_angle_change_deg": 0.459620189632794
    }
  },
  "spike_detection": {
    "total_spikes": 0,
    "top_10_spikes": []
  },
  "detailed_angle_anomalies": {}
};
        console.log("Offline data loaded successfully");
    </script>

</head>
<body>

<div class="container">
    <header>
        <h1>AI Coach <span>骨架一致性驗證</span></h1>
        <div class="upload-section">
            <label for="fileInput" class="file-upload-btn">📂 選擇 JSON 分析檔案</label>
            <input type="file" id="fileInput" accept=".json">
        </div>
    </header>

    <!-- Summary Stats -->
    <div id="summaryStats" class="summary-grid">
        <!-- Injected by JS -->
    </div>

    <!-- Composite Score -->
    <div id="compositeScoreCard" class="score-card" style="display:none;">
        <div class="score-main">
            <div class="score-label">綜合評分</div>
            <div id="compositeScoreValue" class="score-value">--</div>
            <div id="compositeScoreLevel" class="score-level">--</div>
            <div class="score-progress">
                <div id="compositeScoreProgress" class="score-progress-fill" style="width:0%;"></div>
            </div>
            <p id="compositeScoreSummary" class="score-summary">尚未載入資料</p>
        </div>
        <div class="score-details">
            <div class="score-detail-header">
                <h3>評分說明</h3>
                <span class="score-detail-subtitle">顯示每個指標如何影響分數</span>
            </div>
            <div id="compositeScoreDetails" class="score-detail-list">
                <div class="score-detail-item score-empty">
                    <div class="score-detail-label">尚未載入資料</div>
                    <div class="score-detail-desc">扣分明細會顯示在此區塊</div>
                </div>
            </div>
        </div>
    </div>

    <h2 class="section-title">📊 視覺化圖表分析</h2>
    
    <!-- Height Warning Alert -->
    <div id="heightWarning" style="display:none; margin-bottom: 24px; padding: 16px; background: rgba(251, 191, 36, 0.15); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 12px; color: #fbbf24; align-items: center; gap: 12px;">
        <span style="font-size: 1.5rem;">⚠️</span>
        <div>
            <div style="font-weight: 700; font-size: 1.1rem;">身高比例異常警告</div>
            <div id="heightWarningText" style="opacity: 0.9;"></div>
        </div>
    </div>

    <!-- Tooltip Container (Moved to body level for better positioning) -->
    <div id="mapTooltip" style="position: absolute; display: none; background: rgba(0,0,0,0.9); color: #fff; padding: 8px 12px; border-radius: 6px; font-size: 0.85rem; pointer-events: none; border: 1px solid rgba(255,255,255,0.2); z-index: 9999; white-space: nowrap;"></div>

    <div class="grid" id="dashboardGrid">
        <!-- Cards will be injected here by JS -->
    </div>

    <h2 class="section-title">📋 詳細數據分析</h2>
    
    <div class="two-col-grid">
        <div>
            <h3 style="margin-bottom: 16px; color: var(--text-sub);">各部位骨架長度統計 (Bone Statistics)</h3>
            <div class="data-table-container">
                <table id="boneTable">
                    <thead>
                        <tr>
                            <th>部位</th>
                            <th>平均長度 (cm)</th>
                            <th>標準差長度 (Std)</th>
                            <th>變異係數 (CV%)</th>
                            <th>品質</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        
        <div>
            <h3 style="margin-bottom: 16px; color: var(--text-sub);">左右對稱性分析 (Symmetry Analysis)</h3>
            <div class="data-table-container">
                <table id="symmetryTable">
                    <thead>
                        <tr>
                            <th>部位對</th>
                            <th>左側均值 (cm)</th>
                            <th>右側均值 (cm)</th>
                            <th>差異 %</th>
                            <th>評估</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <h3 style="margin-bottom: 16px; color: var(--text-sub);">檢測到的突波 (Top Spikes)</h3>
            <div class="data-table-container">
                <table id="spikesTable">
                    <thead>
                        <tr>
                            <th>Frame</th>
                            <th>Bone/Joint</th>
                            <th>Value (cm)</th>
                            <th>Type</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

</div>

<script>
    // Chart.js Global Defaults for Premium Dark Theme
    Chart.defaults.color = '#9ca3af';
    Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.05)';
    Chart.defaults.font.family = "'Inter', 'Microsoft JhengHei', sans-serif";
    Chart.defaults.font.size = 11;
    
    // Tooltip styling
    Chart.defaults.plugins.tooltip.backgroundColor = 'rgba(20, 20, 20, 0.9)';
    Chart.defaults.plugins.tooltip.titleColor = '#f3f4f6';
    Chart.defaults.plugins.tooltip.bodyColor = '#d1d5db';
    Chart.defaults.plugins.tooltip.borderColor = 'rgba(255, 255, 255, 0.1)';
    Chart.defaults.plugins.tooltip.borderWidth = 1;
    Chart.defaults.plugins.tooltip.padding = 10;
    Chart.defaults.plugins.tooltip.cornerRadius = 8;
    Chart.defaults.plugins.tooltip.displayColors = true;

    const fileInput = document.getElementById('fileInput');
    const dashboardGrid = document.getElementById('dashboardGrid');

    fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                // Pre-process JSON string to handle NaN/Infinity which are valid in Python but not in standard JSON
                let jsonString = e.target.result;
                jsonString = jsonString.replace(/:\s*NaN\b/g, ': null');
                jsonString = jsonString.replace(/:\s*Infinity\b/g, ': null');
                jsonString = jsonString.replace(/:\s*-Infinity\b/g, ': null');
                
                const data = JSON.parse(jsonString);
                renderDashboard(data);
            } catch (error) {
                alert('解析 JSON 失敗，請確認檔案格式正確。\n錯誤: ' + error.message);
                console.error(error);
            }
        };
        reader.readAsText(file);
    });

    // Auto-load from URL parameter or Offline Data
    if (window.OFFLINE_DATA) {
        renderDashboard(window.OFFLINE_DATA);
    } else {
        const urlParams = new URLSearchParams(window.location.search);
        const src = urlParams.get('src');
        if (src) {
            fetch(src)
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.text(); // Get text first to handle NaN
                })
                .then(text => {
                    // Pre-process JSON string to handle NaN/Infinity
                    let jsonString = text;
                    jsonString = jsonString.replace(/:\s*NaN\b/g, ': null');
                    jsonString = jsonString.replace(/:\s*Infinity\b/g, ': null');
                    jsonString = jsonString.replace(/:\s*-Infinity\b/g, ': null');
                    
                    const data = JSON.parse(jsonString);
                    renderDashboard(data);
                })
                .catch(err => {
                    console.error('Error loading JSON from URL:', err);
                    alert('無法從 URL 載入 JSON 檔案: ' + src);
                });
        }
    }

    function createCardHTML(id, title, description, criteria, params) {
        return `
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">${title}</h3>
                </div>
                <div class="chart-wrapper">
                    <div class="chart-container">
                        <canvas id="${id}"></canvas>
                    </div>
                </div>
                <div class="info-section">
                    <div class="info-item">
                        <div class="info-badge badge-desc">說明</div>
                        <p class="info-text">${description}</p>
                    </div>
                    <div class="info-item">
                        <div class="info-badge badge-criteria">判斷標準</div>
                        <p class="info-text text-criteria">${criteria}</p>
                    </div>
                    <div class="info-item">
                        <div class="info-badge badge-params">參數</div>
                        <p class="info-text text-params">${params}</p>
                    </div>
                </div>
            </div>
        `;
    }

    function getStatusBadge(value, type) {
        let status = 'neutral';
        let text = value;
        
        if (type === 'cv') {
            if (value < 5) { status = 'success'; }
            else if (value < 10) { status = 'warning'; }
            else { status = 'danger'; }
            text = value.toFixed(2) + '%';
        } else if (type === 'quality') {
            if (value === '優秀' || value === 'Excellent' || value === '良好' || value === 'Good') { status = 'success'; }
            else if (value === '可接受' || value === 'Acceptable') { status = 'warning'; }
            else { status = 'danger'; }
        } else if (type === 'diff') {
            if (value < 5) { status = 'success'; }
            else if (value < 10) { status = 'warning'; }
            else { status = 'danger'; }
            text = value.toFixed(2) + '%';
        }
        
        return `<span class="status-badge status-${status}">${text}</span>`;
    }

    function clamp(value, min, max) {
        return Math.max(min, Math.min(max, value));
    }

    function describeScoreLevel(score) {
        if (score >= 90) return '卓越 (Excellent)';
        if (score >= 75) return '良好 (Good)';
        if (score >= 60) return '待觀察 (Watch)';
        return '需改善 (Poor)';
    }

    function renderCompositeScoreCard(result) {
        const card = document.getElementById('compositeScoreCard');
        if (!card) return;

        if (!result) {
            card.style.display = 'none';
            return;
        }

        const rawScore = Number.isFinite(result.score) ? result.score : 0;
        const safeScore = clamp(rawScore, 0, 100);
        card.style.display = 'grid';
        document.getElementById('compositeScoreValue').textContent = safeScore.toFixed(1);
        document.getElementById('compositeScoreLevel').textContent = result.level;
        document.getElementById('compositeScoreSummary').textContent = result.summary;
        document.getElementById('compositeScoreProgress').style.width = `${safeScore.toFixed(1)}%`;

        const detailContainer = document.getElementById('compositeScoreDetails');
        const deductions = (result.breakdown || []).filter(item => item.impact > 0);
        if (deductions.length === 0) {
            detailContainer.innerHTML = `
                <div class="score-detail-item score-empty">
                    <div class="score-detail-label">無扣分項目</div>
                    <div class="score-detail-desc">所有骨長/對稱檢查皆通過</div>
                </div>
            `;
        } else {
            detailContainer.innerHTML = deductions.map(item => `
                <div class="score-detail-item">
                    <div>
                        <div class="score-detail-label">${item.label}</div>
                        <div class="score-detail-desc">${item.detail}</div>
                    </div>
                    <div class="score-detail-value">
                        <span>${item.value}</span>
                        <span class="impact-negative">-${item.impact.toFixed(1)}</span>
                    </div>
                </div>
            `).join('');
        }
    }

    function calculateCompositeScoreStep2(data) {
        if (!data || !data.overall_summary) return null;

        // 如果後端已經計算了詳細的分數結構，直接使用後端的結果
        if (data.overall_summary.quality_score && data.overall_summary.quality_score.deductions) {
            const qs = data.overall_summary.quality_score;
            const breakdown = qs.deductions.map(d => ({
                label: d.reason.split('(')[0].trim(),
                value: d.reason.match(/\((.*?)\)/) ? d.reason.match(/\((.*?)\)/)[1] : '',
                detail: d.reason,
                impact: d.points
            }));
            
            return {
                score: qs.score,
                level: qs.level,
                summary: breakdown.length > 0 
                    ? `主要扣分項目: ${breakdown[0].detail}` 
                    : '檢測結果優良，骨架一致性高。',
                breakdown: breakdown
            };
        }

        let workingScore = 100;
        const breakdown = [];
        const summary = data.overall_summary;
        const bones = data.bone_statistics || {};
        const symmetry = Array.isArray(data.symmetry_analysis) ? data.symmetry_analysis : [];
        const spikesTotal = (data.spike_detection && data.spike_detection.total_spikes) || summary.total_spikes_detected || 0;
        const heightWarning = data.body_height_analysis && data.body_height_analysis.scale_warning;

        const register = (label, value, detail, penalty) => {
            const safePenalty = penalty > 0 && Number.isFinite(penalty) ? penalty : 0;
            if (safePenalty > 0) workingScore -= safePenalty;
            breakdown.push({ label, value, detail, impact: safePenalty });
        };

        const avgCv = summary.average_cv || summary.average_cv_percent || 0;
        const avgCvPenalty = avgCv > 4 ? clamp((avgCv - 4) * 2.2, 0, 22) : 0;
        register('平均骨長 CV', `${avgCv.toFixed(2)}%`, '整體穩定度，建議小於 4%', avgCvPenalty);

        let worstBone = null;
        Object.keys(bones).forEach(key => {
            const stat = bones[key];
            if (!worstBone || stat.cv > worstBone.cv) {
                worstBone = { name: key, cv: stat.cv };
            }
        });
        if (worstBone) {
            const worstPenalty = worstBone.cv > 8 ? clamp((worstBone.cv - 8) * 1.8, 0, 20) : 0;
            register(`最高 CV 骨段 (${worstBone.name})`, `${worstBone.cv.toFixed(2)}%`, '單一骨段的離散程度 (建議 < 8%)', worstPenalty);
        } else {
            register('最高 CV 骨段', 'N/A', '缺少骨段統計資料', 0);
        }

        let worstSym = null;
        symmetry.forEach(pair => {
            if (!worstSym || pair.difference_percent > worstSym.difference_percent) {
                worstSym = pair;
            }
        });
        if (worstSym) {
            const symPenalty = worstSym.difference_percent > 5 ? clamp((worstSym.difference_percent - 5) * 1.8, 0, 20) : 0;
            register(`最差對稱組 (${worstSym.pair_name})`, `${worstSym.difference_percent.toFixed(2)}%`, '左右差異 (建議 ≦ 5%)', symPenalty);
        } else {
            register('對稱性', 'N/A', '未提供對稱分析', 0);
        }

        const spikePenalty = spikesTotal > 0 ? clamp(spikesTotal * 0.7, 0, 15) : 0;
        register('突波檢測', `${spikesTotal} 次`, '突然拉長/縮短的次數 (0 次為佳)', spikePenalty);

        if (heightWarning) {
            register('身高尺規偏移', '警示', heightWarning, 5);
        } else {
            register('身高尺規偏移', '正常', '比例合理，未扣分', 0);
        }

        workingScore = clamp(workingScore, 0, 100);
        const totalPenalty = breakdown.reduce((sum, item) => sum + item.impact, 0);
        const leading = breakdown.reduce((max, item) => item.impact > max.impact ? item : max, breakdown[0] || { impact: 0 });
        const summaryText = totalPenalty > 0 && leading
            ? `主要扣分來自「${leading.label}」：${leading.value} 導致 -${leading.impact.toFixed(1)} 分`
            : '骨長、對稱、身高校準皆維持在建議範圍。';

        return {
            score: workingScore,
            level: describeScoreLevel(workingScore),
            summary: summaryText,
            breakdown
        };
    }

    let charts = {}; // Store chart instances

    function renderDashboard(data) {
        // Clear existing charts to prevent memory leaks
        Object.values(charts).forEach(chart => chart.destroy());
        charts = {};

        dashboardGrid.innerHTML = ''; // Clear previous charts
        
        // --- 1. Populate Summary Stats ---
        const statsContainer = document.getElementById('summaryStats');
        const summary = data.overall_summary;
        
        // Height Warning Logic
        if (data.body_height_analysis && data.body_height_analysis.scale_warning) {
            const warningDiv = document.getElementById('heightWarning');
            const warningText = document.getElementById('heightWarningText');
            warningDiv.style.display = 'flex';
            warningText.textContent = data.body_height_analysis.scale_warning;
        }

        // --- Body Map Coloring & Tooltip Logic ---
        // Logic moved to the end of function to ensure DOM elements exist

        
        const summaryItems = [
            { label: '平均變異係數 (CV)', value: `${summary.average_cv.toFixed(2)}%`, sub: '越低越穩定' },
            { label: '整體品質', value: summary.quality_level, sub: `Analyzed ${summary.total_bones_analyzed} bones` },
            { label: '檢測到的突波', value: summary.total_spikes_detected, sub: 'Sudden changes' },
            { label: '身高估計', value: data.body_height_analysis ? `${data.body_height_analysis.mean_cm.toFixed(1)} cm` : 'N/A', sub: data.body_height_analysis ? `±${data.body_height_analysis.std_cm.toFixed(1)} cm` : '' }
        ];

        statsContainer.innerHTML = summaryItems.map(item => `
            <div class="summary-card">
                <div class="summary-label">${item.label}</div>
                <div class="summary-value">${item.value}</div>
                <div class="summary-label" style="opacity: 0.7; font-size: 0.8rem;">${item.sub}</div>
            </div>
        `).join('');

        renderCompositeScoreCard(calculateCompositeScoreStep2(data));


        // --- 2. Populate Bone Statistics Table ---
        const boneTableBody = document.querySelector('#boneTable tbody');
        const boneStats = data.bone_statistics;
        const boneNames = Object.keys(boneStats).sort((a, b) => boneStats[b].cv - boneStats[a].cv);
        
        boneTableBody.innerHTML = boneNames.map(name => {
            const stat = boneStats[name];
            return `
                <tr>
                    <td>${name}</td>
                    <td>${stat.mean.toFixed(1)}</td>
                    <td>${stat.std.toFixed(2)}</td>
                    <td>${getStatusBadge(stat.cv, 'cv')}</td>
                    <td>${getStatusBadge(stat.quality_level, 'quality')}</td>
                </tr>
            `;
        }).join('');


        // --- 3. Populate Symmetry Table ---
        const symTableBody = document.querySelector('#symmetryTable tbody');
        if (data.symmetry_analysis) {
            const sortedSymmetry = [...data.symmetry_analysis].sort((a, b) => b.difference_percent - a.difference_percent);
            symTableBody.innerHTML = sortedSymmetry.map(sym => `
                <tr>
                    <td>${sym.pair_name}</td>
                    <td>${sym.left_mean_cm.toFixed(1)}</td>
                    <td>${sym.right_mean_cm.toFixed(1)}</td>
                    <td>${getStatusBadge(sym.difference_percent, 'diff')}</td>
                    <td>${sym.assessment}</td>
                </tr>
            `).join('');
        } else {
            symTableBody.innerHTML = '<tr><td colspan="5" style="text-align:center; color:var(--text-sub)">無對稱性分析數據</td></tr>';
        }

        // --- 4. Populate Spikes Table ---
        const spikesTableBody = document.querySelector('#spikesTable tbody');
        if (data.spike_detection && data.spike_detection.top_10_spikes) {
            spikesTableBody.innerHTML = data.spike_detection.top_10_spikes.map(spike => `
                <tr>
                    <td>${spike.frame_prev} → ${spike.frame_curr}</td>
                    <td>${spike.bone_zh || spike.bone || 'Unknown'}</td>
                    <td>${spike.diff ? spike.diff.toFixed(2) : 'N/A'} cm</td>
                    <td>突波 (Spike)</td>
                </tr>
            `).join('');
        } else {
            spikesTableBody.innerHTML = '<tr><td colspan="4" style="text-align:center; color:var(--text-sub)">無突波數據</td></tr>';
        }


        // --- 5. Render Charts ---
        const blocks = [
            { 
                id: 'chart_angles', 
                title: '關節角度異常統計 (Joint Angles)', 
                desc: '統計各關節角度超出合理範圍（如膝蓋過度反折）的比例。', 
                criteria: '異常率應 < 1%，若過高表示骨架結構崩壞',
                params: 'X軸: 關節名稱 | Y軸: 異常率 (%)' 
            },
            { 
                id: 'chart1', 
                title: '骨架長度變異係數 (CV%)', 
                desc: '顯示各部位骨架長度的穩定性，CV 值越低代表該部位長度在時間軸上越穩定。', 
                criteria: 'CV < 5% 優秀 | 5-10% 可接受 | > 10% 不穩定',
                params: 'X軸: 部位名稱 | Y軸: CV (%)' 
            },
            { 
                id: 'chart2', 
                title: '骨架長度統計 (Mean & Std)', 
                desc: '顯示各部位的平均長度(Bar)與標準差(Error Bar)。白色工字線代表標準差範圍 (Mean ± Std)。', 
                criteria: '1. 標準差(Std) 建議 < 2.0 cm (穩定)；若 > 5.0 cm 則視為不穩定。\n2. 長度比例參考: 上臂≈前臂, 大腿>小腿, 脊柱≈30-40%身高。',
                params: 'X軸: 部位名稱 | Y軸: 長度 (cm)' 
            },
            { 
                id: 'chart3', 
                title: '左右對稱性比較 (Symmetry)', 
                desc: '比較左右對稱部位（如手臂、腿部）的平均長度差異。', 
                criteria: '差異應 < 5%，若差異過大可能表示重建有偏差',
                params: 'X軸: 部位對 | Y軸: 長度 (cm)' 
            },
            {
                id: 'chart_series',
                title: '骨架長度時序變化 (Length Time Series)',
                desc: '顯示特定部位在每一幀的長度變化，可觀察是否有異常跳動。',
                criteria: '曲線應平滑，無劇烈突波',
                params: 'X軸: Frame | Y軸: 長度 (cm)'
            },
            {
                id: 'chart_cv_series',
                title: '骨架穩定度時序分析 (Rolling CV Analysis)',
                desc: '顯示特定部位在時間軸上的穩定度變化 (Rolling Window CV, Window=30)。',
                criteria: 'CV 突升表示該時間段檢測不穩定',
                params: 'X軸: Frame | Y軸: Rolling CV (%)'
            }
        ];

        // Inject Body Map Card First (Custom HTML)
        // 3D-style Perspective Coordinates (Approximate)
        const bodyMapHtml = `
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">人體部位健康度地圖 (Body Health Map - 3D View)</h3>
                </div>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; align-items: center; height: 100%;">
                    <div style="position: relative; width: 300px; height: 500px;">
                        <!-- 3D-style SVG Stick Figure -->
                        <svg viewBox="0 0 300 500" style="width: 100%; height: 100%; filter: drop-shadow(0 0 10px rgba(0,0,0,0.5));">
                            <defs>
                                <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                                    <feGaussianBlur stdDeviation="2" result="blur" />
                                    <feComposite in="SourceGraphic" in2="blur" operator="over" />
                                </filter>
                                <linearGradient id="boneGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:rgba(255,255,255,0.1)" />
                                    <stop offset="50%" style="stop-color:rgba(255,255,255,0.5)" />
                                    <stop offset="100%" style="stop-color:rgba(255,255,255,0.1)" />
                                </linearGradient>
                            </defs>
                            
                            <!-- Grid Floor for 3D effect -->
                            <path d="M50,450 L250,450 L290,480 L10,480 Z" fill="rgba(255,255,255,0.03)" stroke="rgba(255,255,255,0.1)" />
                            
                            <!-- Bones (Lines) - Using Chinese data-name -->
                            <g stroke-width="6" stroke-linecap="round" opacity="0.9">
                                <!-- Head & Torso -->
                                <line id="bone_head" x1="160" y1="35" x2="140" y2="35" stroke="#555" data-name="頭部" />
                                <line id="visual_neck" x1="150" y1="60" x2="150" y2="90" stroke="#555" />
                                <line id="bone_spine" x1="150" y1="90" x2="150" y2="220" stroke="#555" data-name="脊柱" />
                                <line id="bone_torso" x1="110" y1="90" x2="190" y2="90" stroke="#555" data-name="肩寬" />
                                <line id="bone_pelvis" x1="120" y1="220" x2="180" y2="220" stroke="#555" data-name="骨盆" />
                                
                                <!-- Right Arm (Back) -->
                                <line id="bone_right_upper_arm" x1="110" y1="90" x2="80" y2="160" stroke="#444" data-name="右上臂" />
                                <line id="bone_right_forearm" x1="80" y1="160" x2="60" y2="230" stroke="#444" data-name="右前臂" />
                                
                                <!-- Left Arm (Front) -->
                                <line id="bone_left_upper_arm" x1="190" y1="90" x2="220" y2="160" stroke="#666" data-name="左上臂" />
                                <line id="bone_left_forearm" x1="220" y1="160" x2="240" y2="230" stroke="#666" data-name="左前臂" />
                                
                                <!-- Right Leg (Back) -->
                                <line id="bone_right_thigh" x1="120" y1="220" x2="100" y2="340" stroke="#444" data-name="右大腿" />
                                <line id="bone_right_calf" x1="100" y1="340" x2="90" y2="450" stroke="#444" data-name="右小腿" />
                                
                                <!-- Left Leg (Front) -->
                                <line id="bone_left_thigh" x1="180" y1="220" x2="200" y2="340" stroke="#666" data-name="左大腿" />
                                <line id="bone_left_calf" x1="200" y1="340" x2="210" y2="450" stroke="#666" data-name="左小腿" />
                            </g>

                            <!-- Joints (Circles) -->
                            <g stroke="#fff" stroke-width="2" fill="#222">
                                <!-- Head Group -->
                                <circle id="joint_head" cx="150" cy="40" r="25" class="joint-point" data-name="頭部(Head)" fill-opacity="0.3" stroke-dasharray="2,2" />
                                <circle id="joint_nose" cx="150" cy="45" r="4" class="joint-point" data-name="鼻子(Nose)" />
                                <circle id="joint_left_eye" cx="160" cy="35" r="3" class="joint-point" data-name="左眼(L.Eye)" />
                                <circle id="joint_right_eye" cx="140" cy="35" r="3" class="joint-point" data-name="右眼(R.Eye)" />
                                <circle id="joint_left_ear" cx="170" cy="40" r="3" class="joint-point" data-name="左耳(L.Ear)" />
                                <circle id="joint_right_ear" cx="130" cy="40" r="3" class="joint-point" data-name="右耳(R.Ear)" />

                                <!-- Upper Body -->
                                <circle id="joint_left_shoulder" cx="190" cy="90" r="6" class="joint-point" data-name="左肩(L.Shoulder)" />
                                <circle id="joint_right_shoulder" cx="110" cy="90" r="6" class="joint-point" data-name="右肩(R.Shoulder)" />
                                <circle id="joint_left_elbow" cx="220" cy="160" r="6" class="joint-point" data-name="左肘(L.Elbow)" />
                                <circle id="joint_right_elbow" cx="80" cy="160" r="6" class="joint-point" data-name="右肘(R.Elbow)" />
                                <circle id="joint_left_wrist" cx="240" cy="230" r="5" class="joint-point" data-name="左腕(L.Wrist)" />
                                <circle id="joint_right_wrist" cx="60" cy="230" r="5" class="joint-point" data-name="右腕(R.Wrist)" />

                                <!-- Lower Body -->
                                <circle id="joint_left_hip" cx="180" cy="220" r="7" class="joint-point" data-name="左髖(L.Hip)" />
                                <circle id="joint_right_hip" cx="120" cy="220" r="7" class="joint-point" data-name="右髖(R.Hip)" />
                                <circle id="joint_left_knee" cx="200" cy="340" r="7" class="joint-point" data-name="左膝(L.Knee)" />
                                <circle id="joint_right_knee" cx="100" cy="340" r="7" class="joint-point" data-name="右膝(R.Knee)" />
                                <circle id="joint_left_ankle" cx="210" cy="450" r="6" class="joint-point" data-name="左踝(L.Ankle)" />
                                <circle id="joint_right_ankle" cx="90" cy="450" r="6" class="joint-point" data-name="右踝(R.Ankle)" />
                            </g>
                        </svg>
                        
                        <div style="position: absolute; bottom: 0; right: 0; font-size: 0.7rem; color: var(--text-sub); text-align: right;">
                            <div>🟢 < 5%</div>
                            <div>🟡 5-10%</div>
                            <div>🔴 > 10%</div>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <div class="info-section" style="margin-top: 0; padding: 16px;">
                            <div class="info-item" style="grid-template-columns: 1fr;">
                                <div class="info-badge badge-desc" style="width: fit-content;">說明</div>
                                <p class="info-text" style="font-size: 0.85rem;">
                                    <strong>骨骼 (線):</strong> 長度 CV% (顏色代表穩定度)<br>
                                    <strong>關節 (點):</strong> 深度 CV% (顏色代表深度穩定度)<br>
                                    <span style="color: #fbbf24;">滑鼠懸停查看詳細數據</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        dashboardGrid.innerHTML += bodyMapHtml;

        blocks.forEach(block => {
            if (block.id === 'chart_angles') {
                // Custom HTML for Joint Angles (Text based)
                const angleStats = data.joint_angle_analysis || {};
                const angleLabels = Object.keys(angleStats);
                const getLabel = (k) => {
                    const map = {'left_elbow': '左肘', 'right_elbow': '右肘', 'left_knee': '左膝', 'right_knee': '右膝'};
                    return map[k] || k;
                };

                let angleHtml = `
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">${block.title}</h3>
                        </div>
                        <div style="flex: 1; display: flex; flex-direction: column; gap: 12px; overflow-y: auto; max-height: 300px; padding-right: 8px;">
                `;

                if (angleLabels.length > 0) {
                    angleLabels.forEach(key => {
                        const stat = angleStats[key];
                        const rate = stat.abnormal_rate;
                        let color = '#4ade80';
                        if (rate >= 1) color = '#fbbf24';
                        if (rate >= 5) color = '#f87171';

                        angleHtml += `
                            <div style="background: rgba(255,255,255,0.03); padding: 12px; border-radius: 12px; border-left: 4px solid ${color};">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: 600; font-size: 1rem;">${getLabel(key)}</span>
                                    <span style="font-family: 'JetBrains Mono'; color: ${color}; font-weight: 700;">${rate.toFixed(2)}% 異常</span>
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.85rem; color: var(--text-sub);">
                                    <div>Mean: <span style="color: var(--text-main);">${stat.mean_angle_deg.toFixed(1)}°</span></div>
                                    <div>Range: <span style="color: var(--text-main);">${stat.min_angle_deg.toFixed(0)}° - ${stat.max_angle_deg.toFixed(0)}°</span></div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    angleHtml += `<div style="text-align: center; color: var(--text-sub); padding: 20px;">無關節角度數據</div>`;
                }

                angleHtml += `
                        </div>
                        <div class="info-section" style="margin-top: 24px;">
                            <div class="info-item">
                                <div class="info-badge badge-desc">說明</div>
                                <p class="info-text">${block.desc}</p>
                            </div>
                            <div class="info-item">
                                <div class="info-badge badge-criteria">判斷標準</div>
                                <p class="info-text text-criteria">${block.criteria}</p>
                            </div>
                        </div>
                    </div>
                `;
                dashboardGrid.innerHTML += angleHtml;

            } else if (block.id === 'chart_series') {
                // Custom HTML for Time Series Chart with Dropdown
                const seriesHtml = `
                    <div class="card" style="grid-column: 1 / -1;">
                        <div class="card-header">
                            <h3 class="card-title">${block.title}</h3>
                            <select id="seriesBoneSelect" style="background: rgba(0,0,0,0.3); border: 1px solid var(--card-border); color: var(--text-main); padding: 6px 12px; border-radius: 8px; outline: none;">
                                <!-- Options injected later -->
                            </select>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-container" style="height: 400px;">
                                <canvas id="${block.id}"></canvas>
                            </div>
                        </div>
                        <div class="info-section">
                            <div class="info-item">
                                <div class="info-badge badge-desc">說明</div>
                                <p class="info-text">${block.desc}</p>
                            </div>
                        </div>
                    </div>
                `;
                dashboardGrid.innerHTML += seriesHtml;
            } else if (block.id === 'chart_cv_series') {
                // Custom HTML for Rolling CV Chart with Dropdown
                const cvSeriesHtml = `
                    <div class="card" style="grid-column: 1 / -1;">
                        <div class="card-header">
                            <h3 class="card-title">${block.title}</h3>
                            <select id="cvSeriesBoneSelect" style="background: rgba(0,0,0,0.3); border: 1px solid var(--card-border); color: var(--text-main); padding: 6px 12px; border-radius: 8px; outline: none;">
                                <!-- Options injected later -->
                            </select>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-container" style="height: 400px;">
                                <canvas id="${block.id}"></canvas>
                            </div>
                        </div>
                        <div class="info-section">
                            <div class="info-item">
                                <div class="info-badge badge-desc">說明</div>
                                <p class="info-text">${block.desc}</p>
                            </div>
                        </div>
                    </div>
                `;
                dashboardGrid.innerHTML += cvSeriesHtml;
            } else if (block.id === 'chart3') {
                dashboardGrid.innerHTML += createCardHTML(block.id, block.title, block.desc, block.criteria, block.params);
                
                // Add Body Height Text Block (No Chart) - Moved here
                if (data.body_height_analysis) {
                    const bha = data.body_height_analysis;
                    const meanCm = bha.mean_cm.toFixed(1);
                    const stdCm = bha.std_cm.toFixed(1);
                    const minCm = bha.min_cm.toFixed(1);
                    const maxCm = bha.max_cm.toFixed(1);
                    
                    const heightHtml = `
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">身高估計分佈 (Body Height)</h3>
                            </div>
                            <div style="padding: 24px; display: flex; flex-direction: column; gap: 16px;">
                                <div style="display: flex; align-items: baseline; gap: 12px;">
                                    <span style="font-size: 2.5rem; font-weight: 700; color: var(--text-main);">${meanCm}</span>
                                    <span style="font-size: 1rem; color: var(--text-sub);">cm</span>
                                    <span style="font-size: 1.5rem; font-weight: 600; color: var(--accent-primary); margin-left: 12px;">${(bha.mean_cm * 10).toFixed(0)} mm</span>
                                    <span style="font-size: 1rem; color: ${bha.cv_percent < 5 ? '#4ade80' : '#fbbf24'}; font-weight: 600;">(±${stdCm} cm)</span>
                                </div>
                                <div style="font-size: 0.9rem; color: var(--text-sub); background: rgba(255,255,255,0.05); padding: 8px 12px; border-radius: 6px;">
                                    💡 合理範圍參考: 成人身高通常介於 <strong>140 - 210 cm</strong> 之間。
                                </div>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; background: rgba(255,255,255,0.03); padding: 16px; border-radius: 12px;">
                                    <div>
                                        <div style="font-size: 0.8rem; color: var(--text-sub);">Min / Max</div>
                                        <div style="font-family: 'JetBrains Mono';">${minCm} / ${maxCm} cm</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.8rem; color: var(--text-sub);">CV Stability</div>
                                        <div style="font-family: 'JetBrains Mono'; color: ${bha.cv_percent < 5 ? '#4ade80' : '#f87171'};">${bha.cv_percent.toFixed(2)}%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.8rem; color: var(--text-sub);">Assessment</div>
                                        <div style="font-size: 0.9rem;">${bha.assessment.split('|')[0]}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    dashboardGrid.innerHTML += heightHtml;
                }
            } else {
                dashboardGrid.innerHTML += createCardHTML(block.id, block.title, block.desc, block.criteria, block.params);
            }
        });
        


        // --- Chart 0: Joint Angles (Updated) ---
        // Replaced by custom HTML block above

        // --- Chart Series: Time Series Chart Logic ---
        if (data.bone_statistics) {
            const boneStats = data.bone_statistics;
            const boneNames = Object.keys(boneStats);
            const select = document.getElementById('seriesBoneSelect');
            
            if (select) {
                // Initial render with all datasets
                const ctx = document.getElementById('chart_series').getContext('2d');
                const datasets = boneNames.map((boneName, index) => {
                    const stat = boneStats[boneName];
                    if (!stat || !stat.series_data) return null;
                    return {
                        label: boneName,
                        data: stat.series_data.map((val, i) => ({ x: i, y: val })),
                        borderColor: Chart.defaults.color, // Default color, will be changed
                        hidden: true, // Initially hide all but the first few
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.1
                    };
                }).filter(Boolean);
                
                // Assign unique colors and show first few
                const colors = ['#6366f1', '#a855f7', '#34d399', '#fbbf24', '#f87171', '#4ade80', '#c084fc', '#818cf8', '#f472b6', '#22d3ee'];
                datasets.forEach((ds, i) => {
                    ds.borderColor = colors[i % colors.length];
                    if (i < 5) ds.hidden = false; // Show first 5 by default
                });


                const seriesChart = new Chart(ctx, {
                    type: 'line',
                    data: { datasets },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        scales: {
                            x: { 
                                type: 'linear',
                                title: { display: true, text: 'Frame' },
                                ticks: { precision: 0 }
                            },
                            y: { title: { display: true, text: 'Length (cm)' } }
                        },
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    font: { size: 10 }
                                }
                            }
                        }
                    }
                });
                charts['chart_series'] = seriesChart; // Store chart instance
                
                // Populate dropdown
                select.innerHTML = '<option value="all">顯示前5 (Show Top 5)</option>' + boneNames.map(name => `<option value="${name}">${name}</option>`).join('');

                // Event listener
                select.addEventListener('change', (e) => {
                    const val = e.target.value;
                    seriesChart.data.datasets.forEach(ds => {
                        ds.hidden = (val !== 'all' && ds.label !== val);
                        if (val === 'all') {
                            // Re-apply default visibility
                            const index = seriesChart.data.datasets.indexOf(ds);
                            ds.hidden = index >= 5;
                        }
                    });
                    seriesChart.update();
                });
            }
        }

        // --- Chart CV Series: Rolling CV Logic ---
        if (data.bone_statistics) {
            const boneStats = data.bone_statistics;
            const boneNames = Object.keys(boneStats);
            const selectCV = document.getElementById('cvSeriesBoneSelect');
            
            if (selectCV) {
                const calculateRollingCV = (data, windowSize) => {
                    let result = [];
                    for (let i = 0; i < data.length; i++) {
                        let start = Math.max(0, i - Math.floor(windowSize / 2));
                        let end = Math.min(data.length, i + Math.floor(windowSize / 2) + 1);
                        let windowData = data.slice(start, end);
                        
                        if (windowData.length < 2) {
                            result.push(0); continue;
                        }

                        let mean = windowData.reduce((a, b) => a + b, 0) / windowData.length;
                        let variance = windowData.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / windowData.length;
                        let std = Math.sqrt(variance);
                        let cv = mean !== 0 ? (std / mean) * 100 : 0;
                        result.push(cv);
                    }
                    return result;
                };

                const ctx = document.getElementById('chart_cv_series').getContext('2d');
                const datasets = boneNames.map((boneName, index) => {
                     const stat = boneStats[boneName];
                    if (!stat || !stat.series_data) return null;
                     const rollingCV = calculateRollingCV(stat.series_data, 30);
                     return {
                        label: `${boneName} Rolling CV`,
                        data: rollingCV.map((val, i) => ({ x: i, y: val })),
                        borderColor: Chart.defaults.color,
                        hidden: true,
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.1
                    };
                }).filter(Boolean);

                const colors = ['#6366f1', '#a855f7', '#34d399', '#fbbf24', '#f87171', '#4ade80', '#c084fc', '#818cf8', '#f472b6', '#22d3ee'];
                datasets.forEach((ds, i) => {
                    ds.borderColor = colors[i % colors.length];
                    if (i < 5) ds.hidden = false;
                });
                
                const cvChart = new Chart(ctx, {
                    type: 'line',
                    data: { datasets },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        scales: {
                            x: { 
                                type: 'linear',
                                title: { display: true, text: 'Frame' },
                                ticks: { precision: 0 }
                            },
                            y: { title: { display: true, text: 'CV (%)' }, beginAtZero: true }
                        },
                         plugins: {
                            legend: {
                                position: 'top',
                                labels: { font: { size: 10 } }
                            }
                        }
                    }
                });
                charts['chart_cv_series'] = cvChart;

                selectCV.innerHTML = '<option value="all">顯示前5 (Show Top 5)</option>' + boneNames.map(name => `<option value="${name}">${name}</option>`).join('');
                selectCV.addEventListener('change', (e) => {
                    const val = e.target.value;
                    cvChart.data.datasets.forEach(ds => {
                        ds.hidden = (val !== 'all' && ds.label !== `${val} Rolling CV`);
                        if (val === 'all') {
                            const index = cvChart.data.datasets.indexOf(ds);
                            ds.hidden = index >= 5;
                        }
                    });
                    cvChart.update();
                });
            }
        }

        // --- Chart 1: CV% ---
        // Sort bones by CV desc
        const sortedBones = boneNames.sort((a, b) => boneStats[b].cv - boneStats[a].cv);
        
        new Chart(document.getElementById('chart1'), {
            type: 'bar',
            data: {
                labels: sortedBones,
                datasets: [{
                    label: '變異係數 (CV%)',
                    data: sortedBones.map(b => boneStats[b].cv),
                    backgroundColor: sortedBones.map(b => {
                        const cv = boneStats[b].cv;
                        if (cv < 5) return '#4ade80';
                        if (cv < 10) return '#fbbf24';
                        return '#f87171';
                    }),
                    borderRadius: 4
                }]
            },
            options: { 
                responsive: true, 
                maintainAspectRatio: false,
                scales: { y: { beginAtZero: true, title: { display: true, text: 'CV (%)' } } }
            }
        });

        // --- Chart 2: Mean & Std ---
        // Sort by Mean length desc
        const sortedByLen = boneNames.sort((a, b) => boneStats[b].mean - boneStats[a].mean);
        
        // Custom Plugin for Error Bars
        const errorBarPlugin = {
            id: 'errorBar',
            afterDatasetsDraw: (chart) => {
                const { ctx, data, scales: { y } } = chart;
                
                chart.getDatasetMeta(0).data.forEach((bar, index) => {
                    const value = data.datasets[0].data[index];
                    const std = data.datasets[0].error[index];
                    
                    if (std === undefined || std === null) return;

                    const x = bar.x;
                    const yMean = y.getPixelForValue(value);
                    const yHigh = y.getPixelForValue(value + std);
                    const yLow = y.getPixelForValue(value - std);
                    
                    ctx.save();
                    ctx.beginPath();
                    ctx.lineWidth = 1.5;
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)'; // White-ish for visibility
                    
                    // Vertical line
                    ctx.moveTo(x, yLow);
                    ctx.lineTo(x, yHigh);
                    
                    // Top cap
                    ctx.moveTo(x - 6, yHigh);
                    ctx.lineTo(x + 6, yHigh);
                    
                    // Bottom cap
                    ctx.moveTo(x - 6, yLow);
                    ctx.lineTo(x + 6, yLow);
                    
                    ctx.stroke();
                    ctx.restore();
                });
            }
        };

        new Chart(document.getElementById('chart2'), {
            type: 'bar',
            data: {
                labels: sortedByLen,
                datasets: [{
                    label: '平均長度 (cm)',
                    data: sortedByLen.map(b => boneStats[b].mean), // Already in cm
                    error: sortedByLen.map(b => boneStats[b].std), // Pass std here
                    backgroundColor: '#667eea',
                    borderRadius: 4,
                    barPercentage: 0.6
                }]
            },
            options: { 
                responsive: true, 
                maintainAspectRatio: false,
                scales: { y: { beginAtZero: true, title: { display: true, text: 'Length (cm)' } } },
                plugins: {
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const idx = context.dataIndex;
                                const std = context.dataset.error[idx];
                                return `Std: ±${std.toFixed(2)} cm`;
                            }
                        }
                    }
                }
            },
            plugins: [errorBarPlugin]
        });

        // --- Chart 3: Symmetry ---
        if (data.symmetry_analysis) {
            const symLabels = data.symmetry_analysis.map(s => s.pair_name);
            const leftData = data.symmetry_analysis.map(s => s.left_mean_cm); // Already in cm
            const rightData = data.symmetry_analysis.map(s => s.right_mean_cm); // Already in cm
            
            new Chart(document.getElementById('chart3'), {
                type: 'bar',
                data: {
                    labels: symLabels,
                    datasets: [
                        {
                            label: '左側 (Left)',
                            data: leftData,
                            backgroundColor: data.symmetry_analysis.map(s => (s.left_cv && s.left_cv > 10) ? '#f87171' : '#6366f1'), // Red if unstable
                            borderRadius: 4
                        },
                        {
                            label: '右側 (Right)',
                            data: rightData,
                            backgroundColor: data.symmetry_analysis.map(s => (s.right_cv && s.right_cv > 10) ? '#f87171' : '#a855f7'), // Red if unstable
                            borderRadius: 4
                        }
                    ]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Length (cm)' } } },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    const idx = context.dataIndex;
                                    const item = data.symmetry_analysis[idx];
                                    if (context.dataset.label.includes('Left')) {
                                        return item.left_cv ? `CV: ${item.left_cv.toFixed(1)}%` : '';
                                    } else {
                                        return item.right_cv ? `CV: ${item.right_cv.toFixed(1)}%` : '';
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        // Initialize Body Map Coloring
        initBodyMapColoring(data);
    }

    // --- Body Map Coloring Logic ---
    function initBodyMapColoring(data) {
        if (data.bone_statistics) {
            const bs = data.bone_statistics;
            const ds = data.joint_depth_analysis || {}; // Joint depth stats
            
            // Helper to get color based on CV
            const getCvColor = (cv) => {
                if (cv < 5) return '#4ade80'; // Green
                if (cv < 10) return '#fbbf24'; // Yellow
                return '#f87171'; // Red
            };

            // 1. Color Bones (Lines)
            const setBoneColor = (id) => {
                const el = document.getElementById(id);
                if (!el) return;
                
                const boneName = el.getAttribute('data-name'); // e.g. "脊柱"
                const stat = bs[boneName];

                if (stat) {
                    const color = getCvColor(stat.cv);
                    el.setAttribute('stroke', color);
                    el.dataset.cv = stat.cv.toFixed(2);
                    el.dataset.mean = stat.mean.toFixed(1); // Already in cm
                }
            };

            // Apply to all lines starting with bone_
            document.querySelectorAll('svg line[id^="bone_"]').forEach(el => {
                setBoneColor(el.id);
            });

            // 2. Color Joints (Circles)
            const setJointColor = (id) => {
                const el = document.getElementById(id);
                if (!el) return;
                
                // id is like "joint_left_shoulder"
                // JSON keys are like "left_shoulder"
                let jointKey = id.replace('joint_', '');
                
                // Map special keys if needed
                if (jointKey === 'head') jointKey = 'nose'; // Use nose for head if available
                
                let stat = ds[jointKey];
                
                if (stat) {
                    const color = getCvColor(stat.cv_percent);
                    el.setAttribute('fill', color);
                    el.setAttribute('stroke', color); // Make border same color
                    el.dataset.cv = stat.cv_percent.toFixed(2);
                    el.dataset.z_mean = stat.mean_z_cm.toFixed(1); // Already in cm
                } else {
                    // If no depth data, maybe use bone color or default
                    el.setAttribute('fill', '#555');
                    el.setAttribute('stroke', '#777');
                }
            };

            // Apply to all circles starting with joint_
            document.querySelectorAll('svg circle[id^="joint_"]').forEach(el => {
                setJointColor(el.id);
            });

            // 3. Tooltip Event Listeners
            const tooltip = document.getElementById('mapTooltip');

            const showTooltip = (e) => {
                const target = e.target;
                let content = '';
                
                if (target.tagName === 'line' && target.id.startsWith('bone_')) {
                    // Bone Tooltip
                    const name = target.getAttribute('data-name') || target.id;
                    const cv = target.dataset.cv;
                    const mean = target.dataset.mean;
                    if (cv) {
                        content = `<strong>${name}</strong><br>Length: ${mean} cm<br>CV: ${cv}%`;
                    }
                } else if (target.tagName === 'circle' && target.classList.contains('joint-point')) {
                    // Joint Tooltip
                    const name = target.getAttribute('data-name') || target.id;
                    const cv = target.dataset.cv;
                    const z = target.dataset.z_mean;
                    if (cv) {
                        content = `<strong>${name}</strong><br>Depth (Z): ${z} cm<br>Stability (CV): ${cv}%`;
                    } else {
                        content = `<strong>${name}</strong><br>No depth data`;
                    }
                }

                if (content) {
                    tooltip.innerHTML = content;
                    tooltip.style.display = 'block';
                    tooltip.style.left = (e.pageX + 15) + 'px';
                    tooltip.style.top = (e.pageY + 15) + 'px';
                }
            };

            const hideTooltip = () => {
                tooltip.style.display = 'none';
            };

            // Attach events to all SVG elements
            document.querySelectorAll('svg line, svg circle').forEach(el => {
                el.addEventListener('mousemove', showTooltip);
                el.addEventListener('mouseleave', hideTooltip);
            });
        }
    }
</script>

</body>
</html>
