# 🎬 影片分割工具 - 使用說明

## ✨ 新功能：毫秒級精度

現在支援小數點秒數輸入，精確到 0.001 秒（1 毫秒）！

---

## 🚀 快速啟動

### 方法 1：雙擊批次檔
```
start_video_splitter.bat
```

### 方法 2：命令列
```bash
python video_splitter_gui.py
```

---

## 📖 使用步驟

### 1️⃣ 載入影片
- 點擊「📂 載入影片」按鈕
- 選擇要分割的影片檔案（支援 mp4, avi, mov, mkv）

### 2️⃣ 設定分割區間
- **開始時間**：輸入秒數（支援小數，例如：1.234）
- **結束時間**：輸入秒數（支援小數，例如：5.678）
- **片段名稱**：輸入片段檔名（可選）

💡 **小技巧**：
- 使用時間軸滑桿瀏覽影片
- 點擊「🎯 使用當前時間」快速填入時間

### 3️⃣ 新增多個區間
- 點擊「➕ 新增區間」加入分割點
- 可以一次設定多個區間
- 支援批次分割

### 4️⃣ 選擇輸出設定
- 點擊「📁 選擇資料夾」設定輸出位置
- 選擇編碼器：
  - **GPU加速** (h264_nvenc)：適合 NVIDIA 顯卡
  - **CPU** (libx264)：通用選項
  - **複製串流**：最快，不重新編碼

### 5️⃣ 開始分割
- 點擊「▶️ 開始分割」
- 等待進度完成
- 完成後會顯示輸出訊息

---

## ⏱️ 時間格式說明

### 輸入格式（秒數）
```
整數：     10      → 10秒
一位小數： 10.5    → 10.5秒
兩位小數： 10.75   → 10.75秒
三位小數： 10.123  → 10.123秒（最精確）
```

### 顯示格式
```
HH:MM:SS.mmm

範例：
00:00:01.234  → 1秒234毫秒
00:01:23.500  → 1分23秒500毫秒
01:30:45.001  → 1小時30分45秒1毫秒
```

---

## 🎯 實用範例

### 範例 1：擷取擊球瞬間
```
開始時間： 5.234
結束時間： 6.567
片段名稱： 正手擊球
結果：     1.333秒的精確片段
```

### 範例 2：慢動作分析
```
開始時間： 10.001
結束時間： 10.999
片段名稱： 擊球慢動作
結果：     0.998秒的超短片段
```

### 範例 3：批次分割多個動作
```
區間1： 5.5 → 8.75    (發球)
區間2： 12.3 → 15.6   (正手)
區間3： 20.1 → 23.8   (反手)
結果：  3個精確片段
```

---

## 💾 儲存與載入設定

### 儲存區間設定
- 點擊「💾 儲存設定」
- 選擇儲存位置
- 格式：JSON 檔案

### 載入區間設定
- 點擊「📂 載入設定」
- 選擇之前儲存的 JSON 檔案
- 自動載入所有區間

### 設定檔格式
```json
{
  "video_path": "影片路徑.mp4",
  "segments": [
    {"start": 1.234, "end": 5.678, "name": "片段1"},
    {"start": 10.5, "end": 15.25, "name": "片段2"}
  ]
}
```

---

## ⚙️ 編碼器選擇指南

| 編碼器 | 速度 | 品質 | 檔案大小 | 適用情境 |
|--------|------|------|----------|----------|
| **複製串流** | ⚡⚡⚡ 最快 | 原始 | 最小 | 不需重新編碼，最快速 |
| **GPU加速** | ⚡⚡ 很快 | 良好 | 中等 | 有 NVIDIA 顯卡 |
| **CPU** | ⚡ 較慢 | 優秀 | 較小 | 通用選項，相容性最佳 |

💡 **建議**：
- 快速預覽：使用「複製串流」
- 最終輸出：使用「GPU加速」或「CPU」
- 品質優先：使用「CPU」並降低 CRF 值

---

## 🔧 故障排除

### 問題：無法開啟程式
**解決方法**：
1. 確認已安裝 Python 3.x
2. 安裝必要套件：
   ```bash
   pip install opencv-python
   ```

### 問題：找不到 FFmpeg
**解決方法**：
1. 下載 FFmpeg：https://ffmpeg.org/download.html
2. 安裝到系統 PATH
3. 或使用 Chocolatey：
   ```bash
   choco install ffmpeg
   ```

### 問題：GPU 加速不可用
**解決方法**：
1. 確認有 NVIDIA 顯卡
2. 安裝最新顯卡驅動
3. 使用 CPU 編碼器代替

### 問題：分割時間不精確
**解決方法**：
1. 使用小數點輸入（例如：1.234）
2. 避免使用「複製串流」模式
3. 關鍵幀位置可能影響精度

---

## 📱 鍵盤快捷鍵

目前版本尚未支援快捷鍵，建議使用滑鼠操作。

---

## 🎓 進階技巧

### 1. 幀級精度計算
```
幀數 = 時間 × FPS
範例：30 FPS 影片
- 1 幀 = 1/30 = 0.033 秒
- 半幀 = 0.017 秒
```

### 2. 音樂節拍對齊
```
120 BPM = 每拍 0.5 秒
輸入時間：
- 第1拍：0.0
- 第2拍：0.5
- 第3拍：1.0
- 第4拍：1.5
```

### 3. 批次處理流程
```
1. 設定所有區間
2. 儲存設定（備份）
3. 選擇輸出資料夾
4. 開始分割
5. 檢查輸出檔案
```

---

## 📞 支援與回饋

如有問題或建議，請聯繫開發團隊。

---

**版本**: 1.1.0 (毫秒精度版)  
**更新日期**: 2025-11-25  
**作者**: AI Coach Detection Team
