# 球進入判斷流程圖

```
開始分析影片
    ↓
載入網球偵測模型 (YOLO)
    ↓
讀取影片的每一幀
    ↓
使用 YOLO 偵測網球
    ↓
偵測到球? ──No──→ 繼續下一幀
    ↓ Yes
信心度 ≥ 閾值? ──No──→ 繼續下一幀
    ↓ Yes
計算球的位置 (x, y)
    ↓
判斷球進入情況:
    ├─ 情況A: 前幀無球，當前有球
    │     ↓
    │   球在邊緣區域? ──No──→ 繼續下一幀
    │     ↓ Yes
    │   記錄進入時間
    │
    └─ 情況B: 前幀有球，當前有球  
          ↓
        前幀在邊緣 且 當前在中央? ──No──→ 繼續下一幀
          ↓ Yes
        移動距離 > 20像素? ──No──→ 繼續下一幀
          ↓ Yes
        記錄進入時間
    ↓
檢查時間間隔 (≥ 最小間隔)
    ↓
更新上一幀資訊
    ↓
還有影格? ──Yes──→ 繼續下一幀
    ↓ No
分析完成，輸出所有進入時間點
```

# 影片分割流程圖

```
開始分割
    ↓
檢查 FFmpeg 是否可用
    ├─ Yes → 使用 FFmpeg 分割 (推薦)
    └─ No → 使用 OpenCV 分割 (備用)
    ↓
對每個球進入時間點:
    ↓
計算片段時間:
    ├─ 固定模式: 使用設定的片段長度
    └─ 動態模式: 從當前進入點到下一個進入點
    ↓
建立輸出檔案路徑
    ↓
執行分割:
    ├─ FFmpeg: ffmpeg -i input -ss start -t duration output
    └─ OpenCV: 逐幀讀取並寫入新檔案
    ↓
檢查分割結果
    ├─ 成功 → 記錄檔案資訊
    └─ 失敗 → 記錄錯誤資訊
    ↓
更新進度
    ↓
下一個進入點
    ↓
所有片段完成
    ↓
產生報告並顯示結果
```

# 參數影響示意圖

## 偵測信心度影響：
```
信心度 0.3: ████████████ (偵測到很多球，可能有誤判)
信心度 0.5: ████████     (平衡點，適中)
信心度 0.7: █████        (較嚴格，可能漏掉一些)
信心度 0.9: ██           (非常嚴格，只保留最確定的)
```

## 預覽開始時間影響：
```
球進入時間: 10.0 秒
                    ↓ (球進入點)
預覽 -1.0秒: |-------|████████| (9.0秒開始)
預覽 -0.5秒:     |---|████████| (9.5秒開始)  
預覽  0.0秒:         |████████| (10.0秒開始)
預覽 +0.5秒:         |    |████| (10.5秒開始)
```

## 動態vs固定分割比較：
```
球進入點: |  5s  |     12s     |  18s  |     25s     |

固定模式 (4秒):
          |████| |████| |████| |████|
          5-9s   12-16s 18-22s 25-29s

動態模式:
          |████████████| |██████| |████████████|
          5-12s          12-18s   18-25s
```